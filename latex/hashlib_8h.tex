\hypertarget{hashlib_8h}{}\doxysection{hashlib.\+h File Reference}
\label{hashlib_8h}\index{hashlib.h@{hashlib.h}}


Cryptography Library for the TI-\/84+ CE.  


{\ttfamily \#include $<$stdint.\+h$>$}\newline
{\ttfamily \#include $<$stdbool.\+h$>$}\newline
{\ttfamily \#include $<$stddef.\+h$>$}\newline
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{struct__sha256__ctx}{\+\_\+sha256\+\_\+ctx}}
\item 
struct \mbox{\hyperlink{struct__hash__ctx}{\+\_\+hash\+\_\+ctx}}
\item 
union \mbox{\hyperlink{union__hash__ctx_1_1__hash}{\+\_\+hash\+\_\+ctx\+::\+\_\+hash}}
\item 
struct \mbox{\hyperlink{struct__sha256hmac__ctx}{\+\_\+sha256hmac\+\_\+ctx}}
\item 
struct \mbox{\hyperlink{struct__hmac__ctx}{\+\_\+hmac\+\_\+ctx}}
\item 
union \mbox{\hyperlink{union__hmac__ctx_1_1__hmac}{\+\_\+hmac\+\_\+ctx\+::\+\_\+hmac}}
\item 
struct \mbox{\hyperlink{struct__aes__ctx}{\+\_\+aes\+\_\+ctx}}
\end{DoxyCompactItemize}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{hashlib_8h_a2671e33428186577b97034319c059c40}{fast\+Ram\+\_\+\+Safe}}~((void$\ast$)0x\+E30\+A04)
\item 
\#define \mbox{\hyperlink{hashlib_8h_a28d611d50cc8cf20a1c9fa327e839a56}{fast\+Ram\+\_\+\+Unsafe}}~((void$\ast$)0x\+E30800)
\item 
\#define \mbox{\hyperlink{hashlib_8h_af5aa539ae202ddf9e0c9211309869fc8}{SHA256\+\_\+\+DIGEST\+\_\+\+LEN}}~32
\item 
\#define \mbox{\hyperlink{hashlib_8h_afab0742642db9c0609c00bf8a54f386f}{AES\+\_\+\+BLOCKSIZE}}~16
\item 
\#define \mbox{\hyperlink{hashlib_8h_a6c2d58d8dd281845fdc027b499dea89d}{AES\+\_\+\+IVSIZE}}~\mbox{\hyperlink{hashlib_8h_afab0742642db9c0609c00bf8a54f386f}{AES\+\_\+\+BLOCKSIZE}}
\item 
\mbox{\Hypertarget{hashlib_8h_ab723a524d8d2149cb44285a8b8228f1f}\label{hashlib_8h_ab723a524d8d2149cb44285a8b8228f1f}} 
\#define {\bfseries aes\+\_\+outsize}(len)~ ((((len)\%\mbox{\hyperlink{hashlib_8h_afab0742642db9c0609c00bf8a54f386f}{AES\+\_\+\+BLOCKSIZE}})==0) ? (len) + \mbox{\hyperlink{hashlib_8h_afab0742642db9c0609c00bf8a54f386f}{AES\+\_\+\+BLOCKSIZE}} \+: (((len)$>$$>$4) + 1)$<$$<$4)
\item 
\mbox{\Hypertarget{hashlib_8h_a5441aa332bfebb52cb4480d5a0783334}\label{hashlib_8h_a5441aa332bfebb52cb4480d5a0783334}} 
\#define {\bfseries aes\+\_\+extoutsize}(len)~ (aes\+\_\+outsize((len)) + \mbox{\hyperlink{hashlib_8h_a6c2d58d8dd281845fdc027b499dea89d}{AES\+\_\+\+IVSIZE}})
\end{DoxyCompactItemize}
\doxysubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \mbox{\hyperlink{struct__sha256__ctx}{\+\_\+sha256\+\_\+ctx}} \mbox{\hyperlink{hashlib_8h_a53df9e7d871973d59c7b58a6c3963c5d}{sha256\+\_\+ctx}}
\item 
typedef struct \mbox{\hyperlink{struct__hash__ctx}{\+\_\+hash\+\_\+ctx}} \mbox{\hyperlink{hashlib_8h_aa55779911de10df960d64966c6825da7}{hash\+\_\+ctx}}
\item 
\mbox{\Hypertarget{hashlib_8h_a506ce2c70011cd08b55ba24768cec79a}\label{hashlib_8h_a506ce2c70011cd08b55ba24768cec79a}} 
typedef struct \mbox{\hyperlink{struct__sha256hmac__ctx}{\+\_\+sha256hmac\+\_\+ctx}} {\bfseries sha256hmac\+\_\+ctx}
\item 
typedef struct \mbox{\hyperlink{struct__hmac__ctx}{\+\_\+hmac\+\_\+ctx}} \mbox{\hyperlink{hashlib_8h_a8d813300476744f01319600478572f62}{hmac\+\_\+ctx}}
\item 
typedef struct \mbox{\hyperlink{struct__aes__ctx}{\+\_\+aes\+\_\+ctx}} \mbox{\hyperlink{hashlib_8h_aa188bc2768a3b7aa6ad73cb2c77819e0}{aes\+\_\+ctx}}
\end{DoxyCompactItemize}
\doxysubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \mbox{\hyperlink{hashlib_8h_af36e91f131f610a6612b78700d483bd7}{hash\+\_\+algorithms}} \{ \mbox{\hyperlink{hashlib_8h_af36e91f131f610a6612b78700d483bd7ac7716785728694693ec29eccd5ffa0e1}{SHA256}}
 \}
\item 
enum \mbox{\hyperlink{hashlib_8h_a194ef6b5934dff6dceed4dd819e76340}{aes\+\_\+cipher\+\_\+modes}} \{ \mbox{\hyperlink{hashlib_8h_a194ef6b5934dff6dceed4dd819e76340ad21a3698b98b7368b14ec3d48314a132}{AES\+\_\+\+MODE\+\_\+\+CBC}}
, \mbox{\hyperlink{hashlib_8h_a194ef6b5934dff6dceed4dd819e76340a5ecd63cd0bd97d46f273461b6550cb8e}{AES\+\_\+\+MODE\+\_\+\+CTR}}
 \}
\item 
enum \mbox{\hyperlink{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3}{aes\+\_\+padding\+\_\+schemes}} \{ \mbox{\hyperlink{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3a7b7b54293004c0ab7a4a1f6a899e53f2}{SCHM\+\_\+\+PKCS7}}
, \mbox{\hyperlink{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3a1446879dbb5f2f777c955fcf6723ee4a}{SCHM\+\_\+\+DEFAULT}} = SCHM\+\_\+\+PKCS7
, \mbox{\hyperlink{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3a030a31bd034c7d20a80341ede899a6b7}{SCHM\+\_\+\+ISO2}}
 \}
\item 
enum \mbox{\hyperlink{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfd}{aes\+\_\+error\+\_\+t}} \{ \newline
\mbox{\hyperlink{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfdaacf07636102724d2a7913911b0cf74b2}{AES\+\_\+\+OK}}
, \mbox{\hyperlink{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfda6d39b280aea9d8d62d126eef05d271db}{AES\+\_\+\+INVALID\+\_\+\+ARG}}
, \mbox{\hyperlink{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfdaae5e9a591aeda666b0e425d9a05834e3}{AES\+\_\+\+INVALID\+\_\+\+MSG}}
, \mbox{\hyperlink{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfdad2b49ffeabf14aaf47db3d1bad18f84e}{AES\+\_\+\+INVALID\+\_\+\+CIPHERMODE}}
, \newline
\mbox{\hyperlink{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfda47bbd593fc3bdb7758a790bab86b41d9}{AES\+\_\+\+INVALID\+\_\+\+PADDINGMODE}}
, \mbox{\hyperlink{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfdaba928751c773ffa0287e47e1f86eae8b}{AES\+\_\+\+INVALID\+\_\+\+CIPHERTEXT}}
 \}
\item 
enum \mbox{\hyperlink{hashlib_8h_a0486449f609d0e485bad091a671d9294}{rsa\+\_\+error\+\_\+t}} \{ \newline
\mbox{\hyperlink{hashlib_8h_a0486449f609d0e485bad091a671d9294a2cafdb683e1870a33bcb821420626cae}{RSA\+\_\+\+OK}}
, \mbox{\hyperlink{hashlib_8h_a0486449f609d0e485bad091a671d9294aab9ab38286c4180a1aa9f6e8df42e5db}{RSA\+\_\+\+INVALID\+\_\+\+ARG}}
, \mbox{\hyperlink{hashlib_8h_a0486449f609d0e485bad091a671d9294aedeb18a96b96e292369abed5b2f0a271}{RSA\+\_\+\+INVALID\+\_\+\+MSG}}
, \mbox{\hyperlink{hashlib_8h_a0486449f609d0e485bad091a671d9294a843ec210de66176ef63e2d2b8ebdeb65}{RSA\+\_\+\+INVALID\+\_\+\+MODULUS}}
, \newline
\mbox{\hyperlink{hashlib_8h_a0486449f609d0e485bad091a671d9294a43eadc89540121b902e02afabc7a7eb9}{RSA\+\_\+\+ENCODING\+\_\+\+ERROR}}
 \}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
bool \mbox{\hyperlink{hashlib_8h_a008b7da7adce38b117a17c8165c08df9}{csrand\+\_\+init}} (void)
\begin{DoxyCompactList}\small\item\em Initializes the crypto-\/safe random number generator. \end{DoxyCompactList}\item 
uint32\+\_\+t \mbox{\hyperlink{hashlib_8h_a3cdabe638655bf5d3760c4ab700a43fd}{csrand\+\_\+get}} (void)
\begin{DoxyCompactList}\small\item\em Generates a random 32-\/bit number. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{hashlib_8h_aa3641d44a877ff6eec0eb5cfbfaa5c61}{csrand\+\_\+fill}} (void $\ast$buffer, size\+\_\+t size)
\begin{DoxyCompactList}\small\item\em Fills a buffer to size with random bytes. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{hashlib_8h_ac97f2b17187bed64cb75d98ebb9184f8}{hash\+\_\+init}} (\mbox{\hyperlink{hashlib_8h_aa55779911de10df960d64966c6825da7}{hash\+\_\+ctx}} $\ast$ctx, uint8\+\_\+t hash\+\_\+alg)
\begin{DoxyCompactList}\small\item\em Generic hash initializer. Initializes the given context with the starting state for the given hash algorithm and populates pointers to the methods for update and final for the given hash.. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{hashlib_8h_aaf0fab49f90f31ca034e68c83858d14e}{hash\+\_\+update}} (\mbox{\hyperlink{hashlib_8h_aa55779911de10df960d64966c6825da7}{hash\+\_\+ctx}} $\ast$ctx, const void $\ast$data, size\+\_\+t len)
\begin{DoxyCompactList}\small\item\em Updates the hash context for the given data. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{hashlib_8h_a6de2a3ef1df7da45fbe84b38f72baa71}\label{hashlib_8h_a6de2a3ef1df7da45fbe84b38f72baa71}} 
void {\bfseries hash\+\_\+final} (\mbox{\hyperlink{hashlib_8h_aa55779911de10df960d64966c6825da7}{hash\+\_\+ctx}} $\ast$ctx, void $\ast$digest)
\item 
bool \mbox{\hyperlink{hashlib_8h_aef7b1868edb022ce92f850e6269a2db9}{hash\+\_\+mgf1}} (const void $\ast$data, size\+\_\+t datalen, void $\ast$outbuf, size\+\_\+t outlen, uint8\+\_\+t hash\+\_\+alg)
\begin{DoxyCompactList}\small\item\em Arbitrary Length Hashing Function. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{hashlib_8h_a898e128b3311035c6769837208f34a7d}{hmac\+\_\+init}} (\mbox{\hyperlink{hashlib_8h_a8d813300476744f01319600478572f62}{hmac\+\_\+ctx}} $\ast$ctx, const void $\ast$key, size\+\_\+t keylen, uint8\+\_\+t hash\+\_\+alg)
\begin{DoxyCompactList}\small\item\em Context Initializer for SHA-\/256 HMAC. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{hashlib_8h_a6c5035021e844e83e062c198db85c20e}{hmac\+\_\+update}} (\mbox{\hyperlink{hashlib_8h_a8d813300476744f01319600478572f62}{hmac\+\_\+ctx}} $\ast$ctx, const void $\ast$data, size\+\_\+t len)
\begin{DoxyCompactList}\small\item\em Updates the SHA-\/256 HMAC context for the given data. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{hashlib_8h_aab1ccbb4d4cc9b02116d2ed07a5c9ed3}{hmac\+\_\+final}} (\mbox{\hyperlink{hashlib_8h_a8d813300476744f01319600478572f62}{hmac\+\_\+ctx}} $\ast$ctx, void $\ast$output)
\begin{DoxyCompactList}\small\item\em Finalize Context and Render Digest for SHA-\/256 HMAC. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{hashlib_8h_a1db040f9b150deacb5fca66d4684fa91}{hmac\+\_\+pbkdf2}} (const char $\ast$password, size\+\_\+t passlen, void $\ast$key, size\+\_\+t keylen, const void $\ast$salt, size\+\_\+t saltlen, size\+\_\+t rounds, uint8\+\_\+t hash\+\_\+alg)
\begin{DoxyCompactList}\small\item\em Password-\/\+Based Key Derivation Function. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{hashlib_8h_a3e30c60856defd404e80441ee159aa8b}{aes\+\_\+init}} (const void $\ast$key, const \mbox{\hyperlink{hashlib_8h_aa188bc2768a3b7aa6ad73cb2c77819e0}{aes\+\_\+ctx}} $\ast$ks, size\+\_\+t keylen)
\begin{DoxyCompactList}\small\item\em AES import key to key schedule context. \end{DoxyCompactList}\item 
\mbox{\hyperlink{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfd}{aes\+\_\+error\+\_\+t}} \mbox{\hyperlink{hashlib_8h_aae223cd681fbba1e0d748b64cfd3e6d3}{aes\+\_\+encrypt}} (const void $\ast$plaintext, size\+\_\+t len, void $\ast$ciphertext, const \mbox{\hyperlink{hashlib_8h_aa188bc2768a3b7aa6ad73cb2c77819e0}{aes\+\_\+ctx}} $\ast$ks, const void $\ast$iv, uint8\+\_\+t ciphermode, uint8\+\_\+t paddingmode)
\begin{DoxyCompactList}\small\item\em General-\/\+Purpose AES Encryption. \end{DoxyCompactList}\item 
\mbox{\hyperlink{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfd}{aes\+\_\+error\+\_\+t}} \mbox{\hyperlink{hashlib_8h_a9167498ff02e1c99d730481e94106fd6}{aes\+\_\+decrypt}} (const void $\ast$ciphertext, size\+\_\+t len, void $\ast$plaintext, const \mbox{\hyperlink{hashlib_8h_aa188bc2768a3b7aa6ad73cb2c77819e0}{aes\+\_\+ctx}} $\ast$ks, const void $\ast$iv, uint8\+\_\+t ciphermode, uint8\+\_\+t paddingmode)
\begin{DoxyCompactList}\small\item\em General-\/\+Purpose AES Decryption. \end{DoxyCompactList}\item 
\mbox{\hyperlink{hashlib_8h_a0486449f609d0e485bad091a671d9294}{rsa\+\_\+error\+\_\+t}} \mbox{\hyperlink{hashlib_8h_a993f15527e86e09be9954a7377909e14}{rsa\+\_\+encrypt}} (const void $\ast$msg, size\+\_\+t msglen, void $\ast$ciphertext, const void $\ast$pubkey, size\+\_\+t keylen, uint8\+\_\+t oaep\+\_\+hash\+\_\+alg)
\begin{DoxyCompactList}\small\item\em RSA Encryption. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{hashlib_8h_a9875035ce2ae4859b39cfbbff2d1f609}{digest\+\_\+tostring}} (const void $\ast$digest, size\+\_\+t len, char $\ast$hexstr)
\begin{DoxyCompactList}\small\item\em Convert a digest to a valid hex string. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{hashlib_8h_aade3753b2b7e59ebf301c1c0712f8376}{digest\+\_\+compare}} (const void $\ast$digest1, const void $\ast$digest2, size\+\_\+t len)
\begin{DoxyCompactList}\small\item\em Secure buffer comparison. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Cryptography Library for the TI-\/84+ CE. 

Industry-\/\+Standard Cryptography for the TI-\/84+ CE
\begin{DoxyItemize}
\item Secure Random Number Generator (SRNG)
\item hash\+\_\+sha256, hash\+\_\+mgf1
\item hmac\+\_\+sha256, hmac\+\_\+pbkdf2
\item cipher\+\_\+aes
\item cipher\+\_\+rsa
\item secure buffer comparison
\end{DoxyItemize}

\begin{DoxyAuthor}{Author}
Anthony {\itshape ACagliano} Cagliano 

Adam {\itshape beck} Beckingham 

commandblockguy 
\end{DoxyAuthor}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{hashlib_8h_a2671e33428186577b97034319c059c40}\label{hashlib_8h_a2671e33428186577b97034319c059c40}} 
\index{hashlib.h@{hashlib.h}!fastRam\_Safe@{fastRam\_Safe}}
\index{fastRam\_Safe@{fastRam\_Safe}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{fastRam\_Safe}{fastRam\_Safe}}
{\footnotesize\ttfamily \#define fast\+Ram\+\_\+\+Safe~((void$\ast$)0x\+E30\+A04)}

Pointer to a region of fast RAM that is generally safe to use so long as you don\textquotesingle{}t call Libload. \begin{DoxyWarning}{Warning}
Fast Memory gets clobbered by Lib\+Load. Don\textquotesingle{}t keep long-\/term storage here if you plan to call Lib\+Load. 
\end{DoxyWarning}
\mbox{\Hypertarget{hashlib_8h_a28d611d50cc8cf20a1c9fa327e839a56}\label{hashlib_8h_a28d611d50cc8cf20a1c9fa327e839a56}} 
\index{hashlib.h@{hashlib.h}!fastRam\_Unsafe@{fastRam\_Unsafe}}
\index{fastRam\_Unsafe@{fastRam\_Unsafe}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{fastRam\_Unsafe}{fastRam\_Unsafe}}
{\footnotesize\ttfamily \#define fast\+Ram\+\_\+\+Unsafe~((void$\ast$)0x\+E30800)}

Pointer to the start of the region of fast RAM, including the safe region above as well as a region used by the library\textquotesingle{}s csrng. \begin{DoxyWarning}{Warning}
Fast Memory gets clobbered by Lib\+Load. Don\textquotesingle{}t keep long-\/term storage here if you plan to call Lib\+Load. 

If the CSRNG is run, anything you have stored here will be destroyed. 
\end{DoxyWarning}
\mbox{\Hypertarget{hashlib_8h_af5aa539ae202ddf9e0c9211309869fc8}\label{hashlib_8h_af5aa539ae202ddf9e0c9211309869fc8}} 
\index{hashlib.h@{hashlib.h}!SHA256\_DIGEST\_LEN@{SHA256\_DIGEST\_LEN}}
\index{SHA256\_DIGEST\_LEN@{SHA256\_DIGEST\_LEN}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{SHA256\_DIGEST\_LEN}{SHA256\_DIGEST\_LEN}}
{\footnotesize\ttfamily \#define SHA256\+\_\+\+DIGEST\+\_\+\+LEN~32}

Binary length of the SHA-\/256 hash output. \mbox{\Hypertarget{hashlib_8h_afab0742642db9c0609c00bf8a54f386f}\label{hashlib_8h_afab0742642db9c0609c00bf8a54f386f}} 
\index{hashlib.h@{hashlib.h}!AES\_BLOCKSIZE@{AES\_BLOCKSIZE}}
\index{AES\_BLOCKSIZE@{AES\_BLOCKSIZE}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{AES\_BLOCKSIZE}{AES\_BLOCKSIZE}}
{\footnotesize\ttfamily \#define AES\+\_\+\+BLOCKSIZE~16}

Defines the blocksize of the AES cipher. \mbox{\Hypertarget{hashlib_8h_a6c2d58d8dd281845fdc027b499dea89d}\label{hashlib_8h_a6c2d58d8dd281845fdc027b499dea89d}} 
\index{hashlib.h@{hashlib.h}!AES\_IVSIZE@{AES\_IVSIZE}}
\index{AES\_IVSIZE@{AES\_IVSIZE}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{AES\_IVSIZE}{AES\_IVSIZE}}
{\footnotesize\ttfamily \#define AES\+\_\+\+IVSIZE~\mbox{\hyperlink{hashlib_8h_afab0742642db9c0609c00bf8a54f386f}{AES\+\_\+\+BLOCKSIZE}}}

Defines the length of the AES initalization vector (IV). 

\doxysubsection{Typedef Documentation}
\mbox{\Hypertarget{hashlib_8h_a53df9e7d871973d59c7b58a6c3963c5d}\label{hashlib_8h_a53df9e7d871973d59c7b58a6c3963c5d}} 
\index{hashlib.h@{hashlib.h}!sha256\_ctx@{sha256\_ctx}}
\index{sha256\_ctx@{sha256\_ctx}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{sha256\_ctx}{sha256\_ctx}}
{\footnotesize\ttfamily \mbox{\hyperlink{hashlib_8h_a53df9e7d871973d59c7b58a6c3963c5d}{sha256\+\_\+ctx}}}

Defines hash-\/state data for an instance of SHA-\/256. \begin{DoxyNote}{Note}
This is internal to the struct hash\+\_\+ctx. You should never need to use this. 
\end{DoxyNote}
\mbox{\Hypertarget{hashlib_8h_aa55779911de10df960d64966c6825da7}\label{hashlib_8h_aa55779911de10df960d64966c6825da7}} 
\index{hashlib.h@{hashlib.h}!hash\_ctx@{hash\_ctx}}
\index{hash\_ctx@{hash\_ctx}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hash\_ctx}{hash\_ctx}}
{\footnotesize\ttfamily \mbox{\hyperlink{hashlib_8h_aa55779911de10df960d64966c6825da7}{hash\+\_\+ctx}}}

Defines universal hash-\/state data, including pointer to algorithm-\/specific handling methods and a union of computational states for various hashes. \begin{DoxyNote}{Note}
Allocate a seperate context for each seperate data stream you are hashing. 
\end{DoxyNote}
\mbox{\Hypertarget{hashlib_8h_a8d813300476744f01319600478572f62}\label{hashlib_8h_a8d813300476744f01319600478572f62}} 
\index{hashlib.h@{hashlib.h}!hmac\_ctx@{hmac\_ctx}}
\index{hmac\_ctx@{hmac\_ctx}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hmac\_ctx}{hmac\_ctx}}
{\footnotesize\ttfamily \mbox{\hyperlink{hashlib_8h_a8d813300476744f01319600478572f62}{hmac\+\_\+ctx}}}

Defines hash-\/state data for an instance of SHA-\/256-\/\+HMAC. \begin{DoxyNote}{Note}
If you are hashing multiple data streams concurrently, allocate a seperate context for each. 
\end{DoxyNote}
\mbox{\Hypertarget{hashlib_8h_aa188bc2768a3b7aa6ad73cb2c77819e0}\label{hashlib_8h_aa188bc2768a3b7aa6ad73cb2c77819e0}} 
\index{hashlib.h@{hashlib.h}!aes\_ctx@{aes\_ctx}}
\index{aes\_ctx@{aes\_ctx}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{aes\_ctx}{aes\_ctx}}
{\footnotesize\ttfamily \mbox{\hyperlink{hashlib_8h_aa188bc2768a3b7aa6ad73cb2c77819e0}{aes\+\_\+ctx}}}

Stores AES key instance data\+: key size and round keys generated from an AES key. 

\doxysubsection{Enumeration Type Documentation}
\mbox{\Hypertarget{hashlib_8h_af36e91f131f610a6612b78700d483bd7}\label{hashlib_8h_af36e91f131f610a6612b78700d483bd7}} 
\index{hashlib.h@{hashlib.h}!hash\_algorithms@{hash\_algorithms}}
\index{hash\_algorithms@{hash\_algorithms}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hash\_algorithms}{hash\_algorithms}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{hashlib_8h_af36e91f131f610a6612b78700d483bd7}{hash\+\_\+algorithms}}}

Idenitifiers for selecting hash types. see \mbox{\hyperlink{hashlib_8h_ac97f2b17187bed64cb75d98ebb9184f8}{hash\+\_\+init()}} \begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{SHA256@{SHA256}!hashlib.h@{hashlib.h}}\index{hashlib.h@{hashlib.h}!SHA256@{SHA256}}}\mbox{\Hypertarget{hashlib_8h_af36e91f131f610a6612b78700d483bd7ac7716785728694693ec29eccd5ffa0e1}\label{hashlib_8h_af36e91f131f610a6612b78700d483bd7ac7716785728694693ec29eccd5ffa0e1}} 
SHA256&algorithm type identifier for SHA-\/256 \\
\hline

\end{DoxyEnumFields}
\mbox{\Hypertarget{hashlib_8h_a194ef6b5934dff6dceed4dd819e76340}\label{hashlib_8h_a194ef6b5934dff6dceed4dd819e76340}} 
\index{hashlib.h@{hashlib.h}!aes\_cipher\_modes@{aes\_cipher\_modes}}
\index{aes\_cipher\_modes@{aes\_cipher\_modes}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{aes\_cipher\_modes}{aes\_cipher\_modes}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{hashlib_8h_a194ef6b5934dff6dceed4dd819e76340}{aes\+\_\+cipher\+\_\+modes}}}

Supported AES cipher modes \begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{AES\_MODE\_CBC@{AES\_MODE\_CBC}!hashlib.h@{hashlib.h}}\index{hashlib.h@{hashlib.h}!AES\_MODE\_CBC@{AES\_MODE\_CBC}}}\mbox{\Hypertarget{hashlib_8h_a194ef6b5934dff6dceed4dd819e76340ad21a3698b98b7368b14ec3d48314a132}\label{hashlib_8h_a194ef6b5934dff6dceed4dd819e76340ad21a3698b98b7368b14ec3d48314a132}} 
AES\+\_\+\+MODE\+\_\+\+CBC&selects CBC mode \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{AES\_MODE\_CTR@{AES\_MODE\_CTR}!hashlib.h@{hashlib.h}}\index{hashlib.h@{hashlib.h}!AES\_MODE\_CTR@{AES\_MODE\_CTR}}}\mbox{\Hypertarget{hashlib_8h_a194ef6b5934dff6dceed4dd819e76340a5ecd63cd0bd97d46f273461b6550cb8e}\label{hashlib_8h_a194ef6b5934dff6dceed4dd819e76340a5ecd63cd0bd97d46f273461b6550cb8e}} 
AES\+\_\+\+MODE\+\_\+\+CTR&selects CTR mode \\
\hline

\end{DoxyEnumFields}
\mbox{\Hypertarget{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3}\label{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3}} 
\index{hashlib.h@{hashlib.h}!aes\_padding\_schemes@{aes\_padding\_schemes}}
\index{aes\_padding\_schemes@{aes\_padding\_schemes}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{aes\_padding\_schemes}{aes\_padding\_schemes}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3}{aes\+\_\+padding\+\_\+schemes}}}

Supported AES padding schemes \begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{SCHM\_PKCS7@{SCHM\_PKCS7}!hashlib.h@{hashlib.h}}\index{hashlib.h@{hashlib.h}!SCHM\_PKCS7@{SCHM\_PKCS7}}}\mbox{\Hypertarget{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3a7b7b54293004c0ab7a4a1f6a899e53f2}\label{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3a7b7b54293004c0ab7a4a1f6a899e53f2}} 
SCHM\+\_\+\+PKCS7&PKCS\#7 padding $\vert$ DEFAULT \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{SCHM\_DEFAULT@{SCHM\_DEFAULT}!hashlib.h@{hashlib.h}}\index{hashlib.h@{hashlib.h}!SCHM\_DEFAULT@{SCHM\_DEFAULT}}}\mbox{\Hypertarget{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3a1446879dbb5f2f777c955fcf6723ee4a}\label{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3a1446879dbb5f2f777c955fcf6723ee4a}} 
SCHM\+\_\+\+DEFAULT&selects the scheme marked DEFAULT. Using this is recommended in case a change to the standards would set a stronger padding scheme as default \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{SCHM\_ISO2@{SCHM\_ISO2}!hashlib.h@{hashlib.h}}\index{hashlib.h@{hashlib.h}!SCHM\_ISO2@{SCHM\_ISO2}}}\mbox{\Hypertarget{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3a030a31bd034c7d20a80341ede899a6b7}\label{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3a030a31bd034c7d20a80341ede899a6b7}} 
SCHM\+\_\+\+ISO2&ISO-\/9797 M2 padding \\
\hline

\end{DoxyEnumFields}
\mbox{\Hypertarget{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfd}\label{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfd}} 
\index{hashlib.h@{hashlib.h}!aes\_error\_t@{aes\_error\_t}}
\index{aes\_error\_t@{aes\_error\_t}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{aes\_error\_t}{aes\_error\_t}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfd}{aes\+\_\+error\+\_\+t}}}

AES Error Codes (returned by hashlib\+\_\+\+AESEncrypt/\+Decrypt) \begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{AES\_OK@{AES\_OK}!hashlib.h@{hashlib.h}}\index{hashlib.h@{hashlib.h}!AES\_OK@{AES\_OK}}}\mbox{\Hypertarget{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfdaacf07636102724d2a7913911b0cf74b2}\label{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfdaacf07636102724d2a7913911b0cf74b2}} 
AES\+\_\+\+OK&AES operation completed successfully \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{AES\_INVALID\_ARG@{AES\_INVALID\_ARG}!hashlib.h@{hashlib.h}}\index{hashlib.h@{hashlib.h}!AES\_INVALID\_ARG@{AES\_INVALID\_ARG}}}\mbox{\Hypertarget{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfda6d39b280aea9d8d62d126eef05d271db}\label{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfda6d39b280aea9d8d62d126eef05d271db}} 
AES\+\_\+\+INVALID\+\_\+\+ARG&AES operation failed, bad argument \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{AES\_INVALID\_MSG@{AES\_INVALID\_MSG}!hashlib.h@{hashlib.h}}\index{hashlib.h@{hashlib.h}!AES\_INVALID\_MSG@{AES\_INVALID\_MSG}}}\mbox{\Hypertarget{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfdaae5e9a591aeda666b0e425d9a05834e3}\label{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfdaae5e9a591aeda666b0e425d9a05834e3}} 
AES\+\_\+\+INVALID\+\_\+\+MSG&AES operation failed, message invalid \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{AES\_INVALID\_CIPHERMODE@{AES\_INVALID\_CIPHERMODE}!hashlib.h@{hashlib.h}}\index{hashlib.h@{hashlib.h}!AES\_INVALID\_CIPHERMODE@{AES\_INVALID\_CIPHERMODE}}}\mbox{\Hypertarget{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfdad2b49ffeabf14aaf47db3d1bad18f84e}\label{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfdad2b49ffeabf14aaf47db3d1bad18f84e}} 
AES\+\_\+\+INVALID\+\_\+\+CIPHERMODE&AES operation failed, cipher mode undefined \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{AES\_INVALID\_PADDINGMODE@{AES\_INVALID\_PADDINGMODE}!hashlib.h@{hashlib.h}}\index{hashlib.h@{hashlib.h}!AES\_INVALID\_PADDINGMODE@{AES\_INVALID\_PADDINGMODE}}}\mbox{\Hypertarget{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfda47bbd593fc3bdb7758a790bab86b41d9}\label{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfda47bbd593fc3bdb7758a790bab86b41d9}} 
AES\+\_\+\+INVALID\+\_\+\+PADDINGMODE&AES operation failed, padding mode undefined \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{AES\_INVALID\_CIPHERTEXT@{AES\_INVALID\_CIPHERTEXT}!hashlib.h@{hashlib.h}}\index{hashlib.h@{hashlib.h}!AES\_INVALID\_CIPHERTEXT@{AES\_INVALID\_CIPHERTEXT}}}\mbox{\Hypertarget{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfdaba928751c773ffa0287e47e1f86eae8b}\label{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfdaba928751c773ffa0287e47e1f86eae8b}} 
AES\+\_\+\+INVALID\+\_\+\+CIPHERTEXT&AES operation failed, ciphertext error \\
\hline

\end{DoxyEnumFields}
\mbox{\Hypertarget{hashlib_8h_a0486449f609d0e485bad091a671d9294}\label{hashlib_8h_a0486449f609d0e485bad091a671d9294}} 
\index{hashlib.h@{hashlib.h}!rsa\_error\_t@{rsa\_error\_t}}
\index{rsa\_error\_t@{rsa\_error\_t}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{rsa\_error\_t}{rsa\_error\_t}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{hashlib_8h_a0486449f609d0e485bad091a671d9294}{rsa\+\_\+error\+\_\+t}}}

RSA Encryption Error Codes \begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{RSA\_OK@{RSA\_OK}!hashlib.h@{hashlib.h}}\index{hashlib.h@{hashlib.h}!RSA\_OK@{RSA\_OK}}}\mbox{\Hypertarget{hashlib_8h_a0486449f609d0e485bad091a671d9294a2cafdb683e1870a33bcb821420626cae}\label{hashlib_8h_a0486449f609d0e485bad091a671d9294a2cafdb683e1870a33bcb821420626cae}} 
RSA\+\_\+\+OK&RSA encryption completed successfully \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{RSA\_INVALID\_ARG@{RSA\_INVALID\_ARG}!hashlib.h@{hashlib.h}}\index{hashlib.h@{hashlib.h}!RSA\_INVALID\_ARG@{RSA\_INVALID\_ARG}}}\mbox{\Hypertarget{hashlib_8h_a0486449f609d0e485bad091a671d9294aab9ab38286c4180a1aa9f6e8df42e5db}\label{hashlib_8h_a0486449f609d0e485bad091a671d9294aab9ab38286c4180a1aa9f6e8df42e5db}} 
RSA\+\_\+\+INVALID\+\_\+\+ARG&RSA encryption failed, bad argument \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{RSA\_INVALID\_MSG@{RSA\_INVALID\_MSG}!hashlib.h@{hashlib.h}}\index{hashlib.h@{hashlib.h}!RSA\_INVALID\_MSG@{RSA\_INVALID\_MSG}}}\mbox{\Hypertarget{hashlib_8h_a0486449f609d0e485bad091a671d9294aedeb18a96b96e292369abed5b2f0a271}\label{hashlib_8h_a0486449f609d0e485bad091a671d9294aedeb18a96b96e292369abed5b2f0a271}} 
RSA\+\_\+\+INVALID\+\_\+\+MSG&RSA encryption failed, bad msg or msg too long \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{RSA\_INVALID\_MODULUS@{RSA\_INVALID\_MODULUS}!hashlib.h@{hashlib.h}}\index{hashlib.h@{hashlib.h}!RSA\_INVALID\_MODULUS@{RSA\_INVALID\_MODULUS}}}\mbox{\Hypertarget{hashlib_8h_a0486449f609d0e485bad091a671d9294a843ec210de66176ef63e2d2b8ebdeb65}\label{hashlib_8h_a0486449f609d0e485bad091a671d9294a843ec210de66176ef63e2d2b8ebdeb65}} 
RSA\+\_\+\+INVALID\+\_\+\+MODULUS&RSA encryption failed, modulus invalid \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{RSA\_ENCODING\_ERROR@{RSA\_ENCODING\_ERROR}!hashlib.h@{hashlib.h}}\index{hashlib.h@{hashlib.h}!RSA\_ENCODING\_ERROR@{RSA\_ENCODING\_ERROR}}}\mbox{\Hypertarget{hashlib_8h_a0486449f609d0e485bad091a671d9294a43eadc89540121b902e02afabc7a7eb9}\label{hashlib_8h_a0486449f609d0e485bad091a671d9294a43eadc89540121b902e02afabc7a7eb9}} 
RSA\+\_\+\+ENCODING\+\_\+\+ERROR&RSA encryption failed, OAEP encoding error \\
\hline

\end{DoxyEnumFields}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{hashlib_8h_a008b7da7adce38b117a17c8165c08df9}\label{hashlib_8h_a008b7da7adce38b117a17c8165c08df9}} 
\index{hashlib.h@{hashlib.h}!csrand\_init@{csrand\_init}}
\index{csrand\_init@{csrand\_init}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{csrand\_init()}{csrand\_init()}}
{\footnotesize\ttfamily bool csrand\+\_\+init (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Initializes the crypto-\/safe random number generator. 

The SRNG is initialized by polling the 512-\/bytes from address 0x\+D65800 to 0x\+D66000. This region consists of unmapped memory that contains bus noise. Each bit in that region is polled 1024 times and the address with the bit that is the least biased is selected. That will be the byte the SRNG uses to generate entropy. \begin{DoxyReturn}{Returns}
boolean\+: True if a sufficient entropy source was identified. False otherwise. 
\end{DoxyReturn}
\begin{DoxyNote}{Note}
Catch and respond to a {\bfseries{False}} return from this function. Do not proceed with generating nonces and encryption keys without ensuring the initialization was successful. 

It may be a good idea to call this function in any program that uses hashlib functions for good measure. 
\end{DoxyNote}
\mbox{\Hypertarget{hashlib_8h_a3cdabe638655bf5d3760c4ab700a43fd}\label{hashlib_8h_a3cdabe638655bf5d3760c4ab700a43fd}} 
\index{hashlib.h@{hashlib.h}!csrand\_get@{csrand\_get}}
\index{csrand\_get@{csrand\_get}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{csrand\_get()}{csrand\_get()}}
{\footnotesize\ttfamily uint32\+\_\+t csrand\+\_\+get (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Generates a random 32-\/bit number. 


\begin{DoxyItemize}
\item Populates a 119-\/byte entropy pool by xor\textquotesingle{}ing 7 distinct reads from the unmapped address together per byte.
\item Hashes the entropy pool using SHA-\/256.
\item Breaks the SHA-\/256 hash into 8-\/byte blocks, then xor\textquotesingle{}s all 8 bytes each block together, leaving four (4) composite bytes.
\item Returns the 4-\/byte (32-\/bit) composite as a random number.. \begin{DoxyReturn}{Returns}
A random unsigned 32-\/bit integer. 
\end{DoxyReturn}

\end{DoxyItemize}\mbox{\Hypertarget{hashlib_8h_aa3641d44a877ff6eec0eb5cfbfaa5c61}\label{hashlib_8h_aa3641d44a877ff6eec0eb5cfbfaa5c61}} 
\index{hashlib.h@{hashlib.h}!csrand\_fill@{csrand\_fill}}
\index{csrand\_fill@{csrand\_fill}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{csrand\_fill()}{csrand\_fill()}}
{\footnotesize\ttfamily bool csrand\+\_\+fill (\begin{DoxyParamCaption}\item[{void $\ast$}]{buffer,  }\item[{size\+\_\+t}]{size }\end{DoxyParamCaption})}



Fills a buffer to size with random bytes. 


\begin{DoxyParams}{Parameters}
{\em buffer} & A pointer to a buffer to write random data to. \\
\hline
{\em size} & Number of bytes to write. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
{\bfseries{buffer}} must be at least {\bfseries{size}} bytes large. 
\end{DoxyNote}
\mbox{\Hypertarget{hashlib_8h_ac97f2b17187bed64cb75d98ebb9184f8}\label{hashlib_8h_ac97f2b17187bed64cb75d98ebb9184f8}} 
\index{hashlib.h@{hashlib.h}!hash\_init@{hash\_init}}
\index{hash\_init@{hash\_init}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hash\_init()}{hash\_init()}}
{\footnotesize\ttfamily bool hash\+\_\+init (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{hashlib_8h_aa55779911de10df960d64966c6825da7}{hash\+\_\+ctx}} $\ast$}]{ctx,  }\item[{uint8\+\_\+t}]{hash\+\_\+alg }\end{DoxyParamCaption})}



Generic hash initializer. Initializes the given context with the starting state for the given hash algorithm and populates pointers to the methods for update and final for the given hash.. 


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to a hash context (hash\+\_\+ctx). \\
\hline
{\em hash\+\_\+alg} & The numeric ID of the hashing algorithm to use. See {\bfseries{hash\+\_\+algorithms}}. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Boolean. True if hash initialization succeeded. False if hash ID invalid. 
\end{DoxyReturn}
\mbox{\Hypertarget{hashlib_8h_aaf0fab49f90f31ca034e68c83858d14e}\label{hashlib_8h_aaf0fab49f90f31ca034e68c83858d14e}} 
\index{hashlib.h@{hashlib.h}!hash\_update@{hash\_update}}
\index{hash\_update@{hash\_update}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hash\_update()}{hash\_update()}}
{\footnotesize\ttfamily void hash\+\_\+update (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{hashlib_8h_aa55779911de10df960d64966c6825da7}{hash\+\_\+ctx}} $\ast$}]{ctx,  }\item[{const void $\ast$}]{data,  }\item[{size\+\_\+t}]{len }\end{DoxyParamCaption})}



Updates the hash context for the given data. 


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to a hash context. \\
\hline
{\em data} & Pointer to data to hash. \\
\hline
{\em len} & Number of bytes at {\bfseries{data}} to hash. \\
\hline
\end{DoxyParams}
\begin{DoxyWarning}{Warning}
You must have an initialized hash context or a crash will ensue. 
\end{DoxyWarning}
\mbox{\Hypertarget{hashlib_8h_aef7b1868edb022ce92f850e6269a2db9}\label{hashlib_8h_aef7b1868edb022ce92f850e6269a2db9}} 
\index{hashlib.h@{hashlib.h}!hash\_mgf1@{hash\_mgf1}}
\index{hash\_mgf1@{hash\_mgf1}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hash\_mgf1()}{hash\_mgf1()}}
{\footnotesize\ttfamily bool hash\+\_\+mgf1 (\begin{DoxyParamCaption}\item[{const void $\ast$}]{data,  }\item[{size\+\_\+t}]{datalen,  }\item[{void $\ast$}]{outbuf,  }\item[{size\+\_\+t}]{outlen,  }\item[{uint8\+\_\+t}]{hash\+\_\+alg }\end{DoxyParamCaption})}



Arbitrary Length Hashing Function. 

Computes SHA-\/256 of the data with a counter appended to generate a hash of arbitrary length.


\begin{DoxyParams}{Parameters}
{\em data} & Pointer to data to hash. \\
\hline
{\em datalen} & Number of bytes at {\bfseries{data}} to hash. \\
\hline
{\em outbuf} & Pointer to buffer to write hash output to. \\
\hline
{\em outlen} & Number of bytes to write to {\bfseries{outbuf}}. \\
\hline
{\em hash\+\_\+alg} & The numeric ID of the hashing algorithm to use. See {\bfseries{hash\+\_\+algorithms}}. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
{\bfseries{outbuf}} must be at least {\bfseries{outlen}} bytes large. 
\end{DoxyNote}
\mbox{\Hypertarget{hashlib_8h_a898e128b3311035c6769837208f34a7d}\label{hashlib_8h_a898e128b3311035c6769837208f34a7d}} 
\index{hashlib.h@{hashlib.h}!hmac\_init@{hmac\_init}}
\index{hmac\_init@{hmac\_init}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hmac\_init()}{hmac\_init()}}
{\footnotesize\ttfamily bool hmac\+\_\+init (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{hashlib_8h_a8d813300476744f01319600478572f62}{hmac\+\_\+ctx}} $\ast$}]{ctx,  }\item[{const void $\ast$}]{key,  }\item[{size\+\_\+t}]{keylen,  }\item[{uint8\+\_\+t}]{hash\+\_\+alg }\end{DoxyParamCaption})}



Context Initializer for SHA-\/256 HMAC. 

Initializes the given context with the starting state for SHA-\/256 HMAC.


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to a SHA-\/256 HMAC context. \\
\hline
{\em key} & Pointer to an authentication key used to initialize the base SHA-\/256 context. \\
\hline
{\em keylen} & Length of {\bfseries{key}}, in bytes. \\
\hline
{\em alg} & The numeric ID of the hashing algorithm to use. See {\bfseries{hash\+\_\+algorithms}}. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{hashlib_8h_a6c5035021e844e83e062c198db85c20e}\label{hashlib_8h_a6c5035021e844e83e062c198db85c20e}} 
\index{hashlib.h@{hashlib.h}!hmac\_update@{hmac\_update}}
\index{hmac\_update@{hmac\_update}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hmac\_update()}{hmac\_update()}}
{\footnotesize\ttfamily void hmac\+\_\+update (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{hashlib_8h_a8d813300476744f01319600478572f62}{hmac\+\_\+ctx}} $\ast$}]{ctx,  }\item[{const void $\ast$}]{data,  }\item[{size\+\_\+t}]{len }\end{DoxyParamCaption})}



Updates the SHA-\/256 HMAC context for the given data. 


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to a SHA-\/256 HMAC context. \\
\hline
{\em data} & Pointer to data to hash. \\
\hline
{\em len} & Number of bytes at {\bfseries{data}} to hash. \\
\hline
\end{DoxyParams}
\begin{DoxyWarning}{Warning}
You must call hmac\+\_\+sha256\+\_\+init() first or your hash state will be invalid. 
\end{DoxyWarning}
\mbox{\Hypertarget{hashlib_8h_aab1ccbb4d4cc9b02116d2ed07a5c9ed3}\label{hashlib_8h_aab1ccbb4d4cc9b02116d2ed07a5c9ed3}} 
\index{hashlib.h@{hashlib.h}!hmac\_final@{hmac\_final}}
\index{hmac\_final@{hmac\_final}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hmac\_final()}{hmac\_final()}}
{\footnotesize\ttfamily void hmac\+\_\+final (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{hashlib_8h_a8d813300476744f01319600478572f62}{hmac\+\_\+ctx}} $\ast$}]{ctx,  }\item[{void $\ast$}]{output }\end{DoxyParamCaption})}



Finalize Context and Render Digest for SHA-\/256 HMAC. 


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to a SHA-\/256 HMAC context. \\
\hline
{\em digest} & Pointer to a buffer to write the hash to. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
{\bfseries{digest}} must be at least 32 bytes large. 
\end{DoxyNote}
\mbox{\Hypertarget{hashlib_8h_a1db040f9b150deacb5fca66d4684fa91}\label{hashlib_8h_a1db040f9b150deacb5fca66d4684fa91}} 
\index{hashlib.h@{hashlib.h}!hmac\_pbkdf2@{hmac\_pbkdf2}}
\index{hmac\_pbkdf2@{hmac\_pbkdf2}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hmac\_pbkdf2()}{hmac\_pbkdf2()}}
{\footnotesize\ttfamily bool hmac\+\_\+pbkdf2 (\begin{DoxyParamCaption}\item[{const char $\ast$}]{password,  }\item[{size\+\_\+t}]{passlen,  }\item[{void $\ast$}]{key,  }\item[{size\+\_\+t}]{keylen,  }\item[{const void $\ast$}]{salt,  }\item[{size\+\_\+t}]{saltlen,  }\item[{size\+\_\+t}]{rounds,  }\item[{uint8\+\_\+t}]{hash\+\_\+alg }\end{DoxyParamCaption})}



Password-\/\+Based Key Derivation Function. 

Computes a key derived from a password, a 16-\/byte salt, and a given number of rounds.


\begin{DoxyParams}{Parameters}
{\em password} & Pointer to a string containing the password to derive a key from. \\
\hline
{\em passlen} & The length of the password (in bytes). \\
\hline
{\em key} & The buffer to write the key to. Must be at least {\bfseries{keylen}} bytes large. \\
\hline
{\em keylen} & The length of the key to generate (in bytes). \\
\hline
{\em salt} & A psuedo-\/random string to use when computing the key. \\
\hline
{\em saltlen} & The length of the salt to use (in bytes). \\
\hline
{\em rounds} & The number of times to iterate the hash function per block of {\bfseries{keylen}}. \\
\hline
{\em hash\+\_\+alg} & The numeric ID of the hashing algorithm to use. See {\bfseries{hash\+\_\+algorithms}}. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
Standards recommend a salt of at least 128 bits (16 bytes). 

{\bfseries{rounds}} is used to increase the cost (computational time) of generating a key. What makes password-\/ hashing algorithms secure is the time needed to generate a rainbow table attack against it. More rounds means a more secure key, but more time spent generating it. Current cryptography standards recommend in excess of 1000 rounds but that may not be feasible on the CE. 
\end{DoxyNote}
\mbox{\Hypertarget{hashlib_8h_a3e30c60856defd404e80441ee159aa8b}\label{hashlib_8h_a3e30c60856defd404e80441ee159aa8b}} 
\index{hashlib.h@{hashlib.h}!aes\_init@{aes\_init}}
\index{aes\_init@{aes\_init}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{aes\_init()}{aes\_init()}}
{\footnotesize\ttfamily bool aes\+\_\+init (\begin{DoxyParamCaption}\item[{const void $\ast$}]{key,  }\item[{const \mbox{\hyperlink{hashlib_8h_aa188bc2768a3b7aa6ad73cb2c77819e0}{aes\+\_\+ctx}} $\ast$}]{ks,  }\item[{size\+\_\+t}]{keylen }\end{DoxyParamCaption})}



AES import key to key schedule context. 


\begin{DoxyParams}{Parameters}
{\em key} & Pointer to a buffer containing the AES key. \\
\hline
{\em ks} & Pointer to an AES key schedule context. \\
\hline
{\em keylen} & The size, in bytes, of the key to load. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
True if the key was successfully loaded. False otherwise. 
\end{DoxyReturn}
\begin{DoxyNote}{Note}
It is recommended to cycle your key after encrypting 2$^\wedge$64 blocks of data with the same key. 
\end{DoxyNote}
\mbox{\Hypertarget{hashlib_8h_aae223cd681fbba1e0d748b64cfd3e6d3}\label{hashlib_8h_aae223cd681fbba1e0d748b64cfd3e6d3}} 
\index{hashlib.h@{hashlib.h}!aes\_encrypt@{aes\_encrypt}}
\index{aes\_encrypt@{aes\_encrypt}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{aes\_encrypt()}{aes\_encrypt()}}
{\footnotesize\ttfamily \mbox{\hyperlink{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfd}{aes\+\_\+error\+\_\+t}} aes\+\_\+encrypt (\begin{DoxyParamCaption}\item[{const void $\ast$}]{plaintext,  }\item[{size\+\_\+t}]{len,  }\item[{void $\ast$}]{ciphertext,  }\item[{const \mbox{\hyperlink{hashlib_8h_aa188bc2768a3b7aa6ad73cb2c77819e0}{aes\+\_\+ctx}} $\ast$}]{ks,  }\item[{const void $\ast$}]{iv,  }\item[{uint8\+\_\+t}]{ciphermode,  }\item[{uint8\+\_\+t}]{paddingmode }\end{DoxyParamCaption})}



General-\/\+Purpose AES Encryption. 


\begin{DoxyParams}{Parameters}
{\em plaintext} & Pointer to data to encrypt. \\
\hline
{\em len} & Length of data at {\bfseries{plaintext}} to encrypt. This can be the output of hashlib\+\_\+\+AESCiphertext\+Size(). \\
\hline
{\em ciphertext} & Pointer to buffer to write encrypted data to. \\
\hline
{\em ks} & Pointer to an AES key schedule context. \\
\hline
{\em iv} & Pointer to an initialization vector (a nonce of length equal to the block size). \\
\hline
{\em ciphermode} & The cipher mode to use. Can be either {\itshape AES\+\_\+\+MODE\+\_\+\+CBC} or {\itshape AES\+\_\+\+MODE\+\_\+\+CTR}. \\
\hline
{\em paddingmode} & The padding mode to use. Choose one of the padding modes in {\bfseries{enum}} aes\+\_\+padding\+\_\+schemes. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
{\bfseries{ciphertext}} should large enough to hold the encrypted message. For CBC mode, this is the smallest multiple of the blocksize that will hold the plaintext, plus 1 block if the blocksize divides the plaintext evenly. For CTR mode, this is the same size as the plaintext. 

{\bfseries{plaintext}} and {\bfseries{ciphertext}} are aliasable. 

{\bfseries{IV}} is not written to the ciphertext buffer by this function, only the encrypted message. However, if your ciphertext buffer is large enough, you can do the following to get the IV prepended to the ciphertext. Otherwise you will have to join the IV and the ciphertext into a single larger buffer before sending it through whatever networking protocol you use. 
\begin{DoxyCode}{0}
\DoxyCodeLine{\mbox{\hyperlink{hashlib_8h_aae223cd681fbba1e0d748b64cfd3e6d3}{aes\_encrypt}}(plaintext, len, \&ciphertext[AES\_IV\_SIZE], ks, iv, <cipher\_mode>, <padding\_mode>);}
\DoxyCodeLine{memcpy(ciphertext, iv, AES\_IV\_SIZE);}
\DoxyCodeLine{send\_packet(ciphertext);}

\end{DoxyCode}
 This will require a buffer at least as large as the size returned by cipher\+\_\+aes\+\_\+extoutsize(). 
\end{DoxyNote}
\begin{DoxyReturn}{Returns}
aes\+\_\+error\+\_\+t 
\end{DoxyReturn}
\mbox{\Hypertarget{hashlib_8h_a9167498ff02e1c99d730481e94106fd6}\label{hashlib_8h_a9167498ff02e1c99d730481e94106fd6}} 
\index{hashlib.h@{hashlib.h}!aes\_decrypt@{aes\_decrypt}}
\index{aes\_decrypt@{aes\_decrypt}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{aes\_decrypt()}{aes\_decrypt()}}
{\footnotesize\ttfamily \mbox{\hyperlink{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfd}{aes\+\_\+error\+\_\+t}} aes\+\_\+decrypt (\begin{DoxyParamCaption}\item[{const void $\ast$}]{ciphertext,  }\item[{size\+\_\+t}]{len,  }\item[{void $\ast$}]{plaintext,  }\item[{const \mbox{\hyperlink{hashlib_8h_aa188bc2768a3b7aa6ad73cb2c77819e0}{aes\+\_\+ctx}} $\ast$}]{ks,  }\item[{const void $\ast$}]{iv,  }\item[{uint8\+\_\+t}]{ciphermode,  }\item[{uint8\+\_\+t}]{paddingmode }\end{DoxyParamCaption})}



General-\/\+Purpose AES Decryption. 


\begin{DoxyParams}{Parameters}
{\em ciphertext} & Pointer to data to decrypt. \\
\hline
{\em len} & Length of data at {\bfseries{ciphertext}} to decrypt. \\
\hline
{\em plaintext} & Pointer to buffer to write decryped data to. \\
\hline
{\em ks} & Pointer to an AES key schedule context. \\
\hline
{\em iv} & Pointer to an initialization vector (a nonce of length equal to the block size). \\
\hline
{\em ciphermode} & The cipher mode to use. Can be either {\itshape AES\+\_\+\+MODE\+\_\+\+CBC} or {\itshape AES\+\_\+\+MODE\+\_\+\+CTR}. \\
\hline
{\em paddingmode} & The padding mode to use. Choose one of the padding modes in {\bfseries{enum}} aes\+\_\+padding\+\_\+schemes. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
{\bfseries{plaintext}} and {\bfseries{ciphertext}} are aliasable. 

{\bfseries{IV}} should be the same as what is used for encryption. 
\end{DoxyNote}
\begin{DoxyReturn}{Returns}
aes\+\_\+error\+\_\+t 
\end{DoxyReturn}
\mbox{\Hypertarget{hashlib_8h_a993f15527e86e09be9954a7377909e14}\label{hashlib_8h_a993f15527e86e09be9954a7377909e14}} 
\index{hashlib.h@{hashlib.h}!rsa\_encrypt@{rsa\_encrypt}}
\index{rsa\_encrypt@{rsa\_encrypt}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{rsa\_encrypt()}{rsa\_encrypt()}}
{\footnotesize\ttfamily \mbox{\hyperlink{hashlib_8h_a0486449f609d0e485bad091a671d9294}{rsa\+\_\+error\+\_\+t}} rsa\+\_\+encrypt (\begin{DoxyParamCaption}\item[{const void $\ast$}]{msg,  }\item[{size\+\_\+t}]{msglen,  }\item[{void $\ast$}]{ciphertext,  }\item[{const void $\ast$}]{pubkey,  }\item[{size\+\_\+t}]{keylen,  }\item[{uint8\+\_\+t}]{oaep\+\_\+hash\+\_\+alg }\end{DoxyParamCaption})}



RSA Encryption. 

Performs an in-\/place RSA encryption of a message over a public modulus {\bfseries{pubkey}} and a public exponent, 65537 OAEP encoding of the input message is performed automatically.


\begin{DoxyParams}{Parameters}
{\em msg} & Pointer to a message to encrypt using RSA. \\
\hline
{\em msglen} & The length of the message {\bfseries{msg}}. \\
\hline
{\em ciphertext} & Pointer a buffer to write the ciphertext to. \\
\hline
{\em pubkey} & Pointer to a public key to use for encryption. \\
\hline
{\em keylen} & The length of the public key (modulus) to encrypt with. \\
\hline
{\em oaep\+\_\+hash\+\_\+alg} & The numeric ID of the hashing algorithm to use within OAEP encoding. See {\bfseries{hash\+\_\+algorithms}}. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
The size of {\bfseries{ciphertext}} and {\bfseries{keylen}} must be equal. 

The {\bfseries{msg}} will be encoded using OAEP before encryption. 

msg and pubkey are both treated as byte arrays. 
\end{DoxyNote}
\begin{DoxyReturn}{Returns}
rsa\+\_\+error\+\_\+t 
\end{DoxyReturn}
\mbox{\Hypertarget{hashlib_8h_a9875035ce2ae4859b39cfbbff2d1f609}\label{hashlib_8h_a9875035ce2ae4859b39cfbbff2d1f609}} 
\index{hashlib.h@{hashlib.h}!digest\_tostring@{digest\_tostring}}
\index{digest\_tostring@{digest\_tostring}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{digest\_tostring()}{digest\_tostring()}}
{\footnotesize\ttfamily bool digest\+\_\+tostring (\begin{DoxyParamCaption}\item[{const void $\ast$}]{digest,  }\item[{size\+\_\+t}]{len,  }\item[{char $\ast$}]{hexstr }\end{DoxyParamCaption})}



Convert a digest to a valid hex string. 


\begin{DoxyParams}{Parameters}
{\em digest} & Pointer to a buffer or digest to convert. \\
\hline
{\em len} & Number of bytes at {\bfseries{digest}} to convert. \\
\hline
{\em hexstr} & A buffer to write the output hex string to. Must be at least 2 $\ast$ len + 1 bytes large. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{hashlib_8h_aade3753b2b7e59ebf301c1c0712f8376}\label{hashlib_8h_aade3753b2b7e59ebf301c1c0712f8376}} 
\index{hashlib.h@{hashlib.h}!digest\_compare@{digest\_compare}}
\index{digest\_compare@{digest\_compare}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{digest\_compare()}{digest\_compare()}}
{\footnotesize\ttfamily bool digest\+\_\+compare (\begin{DoxyParamCaption}\item[{const void $\ast$}]{digest1,  }\item[{const void $\ast$}]{digest2,  }\item[{size\+\_\+t}]{len }\end{DoxyParamCaption})}



Secure buffer comparison. 

Evaluates the equality of two buffers using a method that offers resistance to timing attacks.


\begin{DoxyParams}{Parameters}
{\em digest1} & The first buffer to compare. \\
\hline
{\em digest2} & The second buffer to compare. \\
\hline
{\em len} & The number of bytes to compare. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
True if the buffers were equal. False if not equal. 
\end{DoxyReturn}
