\hypertarget{hashlib_8h}{}\doxysection{hashlib.\+h File Reference}
\label{hashlib_8h}\index{hashlib.h@{hashlib.h}}


Cryptography Library for the TI-\/84+ CE.  


{\ttfamily \#include $<$stdint.\+h$>$}\newline
{\ttfamily \#include $<$stdbool.\+h$>$}\newline
{\ttfamily \#include $<$stddef.\+h$>$}\newline
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{struct__sha256__ctx}{\+\_\+sha256\+\_\+ctx}}
\item 
struct \mbox{\hyperlink{struct__aes__ctx}{\+\_\+aes\+\_\+ctx}}
\end{DoxyCompactItemize}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{hashlib_8h_a97c7527aa5efe0f229c45c54ebcc6b55}{hashlib\+\_\+\+Fast\+Mem\+Buffer\+Safe}}~((void$\ast$)0x\+E30\+A04)
\item 
\#define \mbox{\hyperlink{hashlib_8h_ab981c88a4cd7407b2c4b4bfe86fc021b}{hashlib\+\_\+\+Fast\+Mem\+Buffer\+Unsafe}}~((void$\ast$)0x\+E30800)
\item 
\#define \mbox{\hyperlink{hashlib_8h_a939c5eb79064fb776e34fd0c632a588b}{SHA256\+\_\+\+MBUFFER\+\_\+\+LEN}}~(64 $\ast$ 4)
\item 
\#define \mbox{\hyperlink{hashlib_8h_af5aa539ae202ddf9e0c9211309869fc8}{SHA256\+\_\+\+DIGEST\+\_\+\+LEN}}~32
\item 
\#define \mbox{\hyperlink{hashlib_8h_a7a767ce32adaa3ad3e7e4aafff0ae7e3}{SHA256\+\_\+\+HEXSTR\+\_\+\+LEN}}~(\mbox{\hyperlink{hashlib_8h_af5aa539ae202ddf9e0c9211309869fc8}{SHA256\+\_\+\+DIGEST\+\_\+\+LEN}}$<$$<$1) + 1
\item 
\#define \mbox{\hyperlink{hashlib_8h_afab0742642db9c0609c00bf8a54f386f}{AES\+\_\+\+BLOCKSIZE}}~16
\item 
\#define \mbox{\hyperlink{hashlib_8h_afc06a029c783f78badc2c26cf6f2297c}{AES\+\_\+\+IV\+\_\+\+SIZE}}~\mbox{\hyperlink{hashlib_8h_afab0742642db9c0609c00bf8a54f386f}{AES\+\_\+\+BLOCKSIZE}}
\item 
\#define \mbox{\hyperlink{hashlib_8h_acf32bb8a8d871f4cf33f26c8b2a977fb}{AES\+\_\+\+MAC\+\_\+\+SIZE}}~\mbox{\hyperlink{hashlib_8h_afab0742642db9c0609c00bf8a54f386f}{AES\+\_\+\+BLOCKSIZE}}
\item 
\#define \mbox{\hyperlink{hashlib_8h_a2841462d8933d0982e3ea13dc5284d7c}{AES128\+\_\+\+KEYLEN}}~16
\item 
\#define \mbox{\hyperlink{hashlib_8h_a37ba5c621bf4af2ddcb851e179e21623}{AES192\+\_\+\+KEYLEN}}~24
\item 
\#define \mbox{\hyperlink{hashlib_8h_a7bab8a778d065da4cc561f4813994f03}{AES256\+\_\+\+KEYLEN}}~32
\item 
\#define \mbox{\hyperlink{hashlib_8h_af7f9757a799b724cfd578ac0a45f58be}{hashlib\+\_\+\+AESPadded\+Size}}(len)~ ((((len)\%\mbox{\hyperlink{hashlib_8h_afab0742642db9c0609c00bf8a54f386f}{AES\+\_\+\+BLOCKSIZE}})==0) ? (len) + \mbox{\hyperlink{hashlib_8h_afab0742642db9c0609c00bf8a54f386f}{AES\+\_\+\+BLOCKSIZE}} \+: (((len)$>$$>$4) + 1)$<$$<$4)
\item 
\#define \mbox{\hyperlink{hashlib_8h_a140213b514394151a1d6ba410ec32bc4}{hashlib\+\_\+\+AESCiphertext\+Len}}(len)~(\mbox{\hyperlink{hashlib_8h_af7f9757a799b724cfd578ac0a45f58be}{hashlib\+\_\+\+AESPadded\+Size}}((len)) + \mbox{\hyperlink{hashlib_8h_afc06a029c783f78badc2c26cf6f2297c}{AES\+\_\+\+IV\+\_\+\+SIZE}})
\item 
\#define \mbox{\hyperlink{hashlib_8h_a89e00bf4bceabd69cff65a5cbf685bd1}{hashlib\+\_\+\+AESAuth\+Mac\+Ciphertext\+Len}}(len)~ (\mbox{\hyperlink{hashlib_8h_a140213b514394151a1d6ba410ec32bc4}{hashlib\+\_\+\+AESCiphertext\+Len}}((len)) + \mbox{\hyperlink{hashlib_8h_acf32bb8a8d871f4cf33f26c8b2a977fb}{AES\+\_\+\+MAC\+\_\+\+SIZE}})
\item 
\#define \mbox{\hyperlink{hashlib_8h_abc4277e4f58f162b211ca4c2a38c2a5a}{hashlib\+\_\+\+AESAuth\+Sha256\+Ciphertext\+Len}}(len)~ (\mbox{\hyperlink{hashlib_8h_a140213b514394151a1d6ba410ec32bc4}{hashlib\+\_\+\+AESCiphertext\+Len}}((len)) + \mbox{\hyperlink{hashlib_8h_af5aa539ae202ddf9e0c9211309869fc8}{SHA256\+\_\+\+DIGEST\+\_\+\+LEN}})
\item 
\#define \mbox{\hyperlink{hashlib_8h_a864d96afe89419821aed4293d979b2b9}{hashlib\+\_\+\+AESKeygen}}(key,  keylen)~\mbox{\hyperlink{hashlib_8h_aa0092aa4c122591fae447dda8fa25dfc}{hashlib\+\_\+\+Random\+Bytes}}((key), (keylen))
\item 
\#define \mbox{\hyperlink{hashlib_8h_ad4ea46d5db12669bb2687771d094638f}{hashlib\+\_\+\+Malloc\+Context}}(size)~malloc((size))
\end{DoxyCompactItemize}
\doxysubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{hashlib_8h_ae34dac71f172c86c1a57258bb0476324}\label{hashlib_8h_ae34dac71f172c86c1a57258bb0476324}} 
typedef struct \mbox{\hyperlink{struct__sha256__ctx}{\+\_\+sha256\+\_\+ctx}} {\bfseries sha256\+\_\+ctx}
\item 
\mbox{\Hypertarget{hashlib_8h_a65315f1d62f11ec21b75450e86ce9774}\label{hashlib_8h_a65315f1d62f11ec21b75450e86ce9774}} 
typedef struct \mbox{\hyperlink{struct__aes__ctx}{\+\_\+aes\+\_\+ctx}} {\bfseries aes\+\_\+ctx}
\end{DoxyCompactItemize}
\doxysubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \mbox{\hyperlink{hashlib_8h_a194ef6b5934dff6dceed4dd819e76340}{aes\+\_\+cipher\+\_\+modes}} \{ \mbox{\hyperlink{hashlib_8h_a194ef6b5934dff6dceed4dd819e76340ad21a3698b98b7368b14ec3d48314a132}{AES\+\_\+\+MODE\+\_\+\+CBC}}
, \mbox{\hyperlink{hashlib_8h_a194ef6b5934dff6dceed4dd819e76340a5ecd63cd0bd97d46f273461b6550cb8e}{AES\+\_\+\+MODE\+\_\+\+CTR}}
 \}
\item 
enum \mbox{\hyperlink{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3}{aes\+\_\+padding\+\_\+schemes}} \{ \mbox{\hyperlink{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3a7b7b54293004c0ab7a4a1f6a899e53f2}{SCHM\+\_\+\+PKCS7}}
, \mbox{\hyperlink{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3a1446879dbb5f2f777c955fcf6723ee4a}{SCHM\+\_\+\+DEFAULT}} = SCHM\+\_\+\+PKCS7
, \mbox{\hyperlink{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3a030a31bd034c7d20a80341ede899a6b7}{SCHM\+\_\+\+ISO2}}
 \}
\item 
enum \mbox{\hyperlink{hashlib_8h_a5aedfaf159c585059ba8914b59307c21}{\+\_\+ssl\+\_\+sig\+\_\+modes}} \{ \mbox{\hyperlink{hashlib_8h_a5aedfaf159c585059ba8914b59307c21a096ad031cbdad23c8d4053d9b7a3db31}{SSLSIG\+\_\+\+RSA\+\_\+\+SHA256}}
, \mbox{\hyperlink{hashlib_8h_a5aedfaf159c585059ba8914b59307c21a3b885e134e618304b93f54b88eff9b25}{SSLSIG\+\_\+\+ECDSA}}
 \}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void $\ast$ \mbox{\hyperlink{hashlib_8h_a179d02d08f13b8a2ec239ae3f6fc81de}{hashlib\+\_\+\+SPRNGInit}} (void)
\begin{DoxyCompactList}\small\item\em Initializes the SPRNG. \end{DoxyCompactList}\item 
uint32\+\_\+t \mbox{\hyperlink{hashlib_8h_ad4e253aa114047e5a49af2fd49781559}{hashlib\+\_\+\+SPRNGRandom}} (void)
\begin{DoxyCompactList}\small\item\em Generates a random 32-\/bit number. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{hashlib_8h_aa0092aa4c122591fae447dda8fa25dfc}{hashlib\+\_\+\+Random\+Bytes}} (uint8\+\_\+t $\ast$buffer, size\+\_\+t size)
\begin{DoxyCompactList}\small\item\em Fills a buffer to size with random bytes. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{hashlib_8h_ad2fa6bc8d3a1156a5734b81f5195afc4}{hashlib\+\_\+\+Sha256\+Init}} (\mbox{\hyperlink{struct__sha256__ctx}{sha256\+\_\+ctx}} $\ast$ctx, uint32\+\_\+t $\ast$mbuffer)
\begin{DoxyCompactList}\small\item\em Context initializer for SHA-\/256. Initializes the given context with the starting state for SHA-\/256. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{hashlib_8h_aeed1dabf7c19464f01c87dcb25a77636}{hashlib\+\_\+\+Sha256\+Update}} (\mbox{\hyperlink{struct__sha256__ctx}{sha256\+\_\+ctx}} $\ast$ctx, const uint8\+\_\+t $\ast$buf, uint32\+\_\+t len)
\begin{DoxyCompactList}\small\item\em Updates the SHA-\/256 context for the given data. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{hashlib_8h_a27eda4d2b18a026f199abdcab6d1cc8c}{hashlib\+\_\+\+Sha256\+Final}} (\mbox{\hyperlink{struct__sha256__ctx}{sha256\+\_\+ctx}} $\ast$ctx, uint8\+\_\+t $\ast$digest)
\begin{DoxyCompactList}\small\item\em Finalize Context and Render Digest for SHA-\/256. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{hashlib_8h_a2c1bd7ec5809afead6583128c9052d8b}{hashlib\+\_\+\+MGF1\+Hash}} (uint8\+\_\+t $\ast$data, size\+\_\+t datalen, uint8\+\_\+t $\ast$outbuf, size\+\_\+t outlen)
\begin{DoxyCompactList}\small\item\em Arbitrary Length Hashing Function. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{hashlib_8h_a0653a6a286fb1bedfb3e964d36e3b0bd}{hashlib\+\_\+\+AESLoad\+Key}} (const uint8\+\_\+t $\ast$key, const \mbox{\hyperlink{struct__aes__ctx}{aes\+\_\+ctx}} $\ast$ks, size\+\_\+t keylen)
\begin{DoxyCompactList}\small\item\em AES import key to key schedule context. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{hashlib_8h_a6987499522b3b85b8ce4b272fadf75dd}{hashlib\+\_\+\+AESEncrypt\+Block}} (const uint8\+\_\+t $\ast$block\+\_\+in, uint8\+\_\+t $\ast$block\+\_\+out, const \mbox{\hyperlink{struct__aes__ctx}{aes\+\_\+ctx}} $\ast$ks)
\begin{DoxyCompactList}\small\item\em AES Single-\/\+Block Encryption (ECB mode) \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{hashlib_8h_a5dd423839387f0955b6061986c92a2ac}{hashlib\+\_\+\+AESDecrypt\+Block}} (const uint8\+\_\+t $\ast$block\+\_\+in, uint8\+\_\+t $\ast$block\+\_\+out, const \mbox{\hyperlink{struct__aes__ctx}{aes\+\_\+ctx}} $\ast$ks)
\begin{DoxyCompactList}\small\item\em AES Single-\/\+Block Decryption (ECB Mode) \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{hashlib_8h_a745c5c4d6bdc248f20b18c7b848d8b6b}{hashlib\+\_\+\+AESEncrypt}} (const uint8\+\_\+t $\ast$plaintext, size\+\_\+t len, uint8\+\_\+t $\ast$ciphertext, const \mbox{\hyperlink{struct__aes__ctx}{aes\+\_\+ctx}} $\ast$ks, const uint8\+\_\+t $\ast$iv, uint8\+\_\+t ciphermode)
\begin{DoxyCompactList}\small\item\em General-\/\+Purpose AES Encryption. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{hashlib_8h_a2b904b543405fdf8f283d028ce0d1da7}{hashlib\+\_\+\+AESDecrypt}} (const uint8\+\_\+t $\ast$ciphertext, size\+\_\+t len, uint8\+\_\+t $\ast$plaintext, const \mbox{\hyperlink{struct__aes__ctx}{aes\+\_\+ctx}} $\ast$ks, const uint8\+\_\+t $\ast$iv, uint8\+\_\+t ciphermode)
\begin{DoxyCompactList}\small\item\em General-\/\+Purpose AES Decryption. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{hashlib_8h_a6ca5ecde1fd675effbc4a29eac35a903}{hashlib\+\_\+\+AESOutput\+Mac}} (const uint8\+\_\+t $\ast$plaintext, size\+\_\+t len, uint8\+\_\+t $\ast$mac, const \mbox{\hyperlink{struct__aes__ctx}{aes\+\_\+ctx}} $\ast$ks)
\begin{DoxyCompactList}\small\item\em Returns a message authentication code for an AES message. \end{DoxyCompactList}\item 
size\+\_\+t \mbox{\hyperlink{hashlib_8h_aebac98a8537f3353aac9fbae5ed67f29}{hashlib\+\_\+\+AESPad\+Message}} (const uint8\+\_\+t $\ast$plaintext, size\+\_\+t len, uint8\+\_\+t $\ast$outbuf, uint8\+\_\+t schm)
\begin{DoxyCompactList}\small\item\em Pads a plaintext according to the specified AES padding scheme. \end{DoxyCompactList}\item 
size\+\_\+t \mbox{\hyperlink{hashlib_8h_a152d6d62f1a21c97a551cea7e6110e59}{hashlib\+\_\+\+AESStrip\+Padding}} (const uint8\+\_\+t $\ast$plaintext, size\+\_\+t len, uint8\+\_\+t $\ast$outbuf, uint8\+\_\+t schm)
\begin{DoxyCompactList}\small\item\em Strips the padding from a message according to the specified AES padding scheme. \end{DoxyCompactList}\item 
size\+\_\+t \mbox{\hyperlink{hashlib_8h_a52c65f6e14ae6287fc2753895ce947be}{hashlib\+\_\+\+RSAEncode\+OAEP}} (const uint8\+\_\+t $\ast$plaintext, size\+\_\+t len, uint8\+\_\+t $\ast$outbuf, size\+\_\+t modulus\+\_\+len, const uint8\+\_\+t $\ast$auth)
\begin{DoxyCompactList}\small\item\em RSA-\/\+OAEP padding scheme. \end{DoxyCompactList}\item 
size\+\_\+t \mbox{\hyperlink{hashlib_8h_ae575c99825f9b970c3d6f7a6bf552153}{hashlib\+\_\+\+RSADecode\+OAEP}} (const uint8\+\_\+t $\ast$plaintext, size\+\_\+t len, uint8\+\_\+t $\ast$outbuf, const uint8\+\_\+t $\ast$auth)
\begin{DoxyCompactList}\small\item\em RSA-\/\+OAEP padding scheme, reverse algorithm. \end{DoxyCompactList}\item 
size\+\_\+t \mbox{\hyperlink{hashlib_8h_a01668b3f2dd85fe2f8696673b275b75a}{hashlib\+\_\+\+RSAEncode\+PSS}} (const uint8\+\_\+t $\ast$plaintext, size\+\_\+t len, uint8\+\_\+t $\ast$outbuf, size\+\_\+t modulus\+\_\+len, uint8\+\_\+t $\ast$salt)
\begin{DoxyCompactList}\small\item\em RSA-\/\+PSS padding scheme. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{hashlib_8h_a24bf91aef912b8346523f37e16d22377}{hashlib\+\_\+\+Erase\+Context}} (void $\ast$ctx, size\+\_\+t len)
\begin{DoxyCompactList}\small\item\em Secure erase context. \end{DoxyCompactList}\item 
\mbox{\hyperlink{hashlib_8h_a658b0b7f7139a429e3b77a9876e78970}{hashlib\+\_\+\+Compare\+Digest}} (const uint8\+\_\+t $\ast$digest1, const uint8\+\_\+t $\ast$digest2, size\+\_\+t len)
\begin{DoxyCompactList}\small\item\em Secure buffer comparison. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Cryptography Library for the TI-\/84+ CE. 

Provides several cryptographic implementations for the TI-\/84+ CE graphing calculator.
\begin{DoxyItemize}
\item secure random number generator
\item SHA-\/256
\item AES\+: CBC, CTR, CBC-\/\+MAC
\item AES Padding\+: PKCS\#7, ISO\+\_\+\+M2
\item RSA public key encryption, modulus $<$= 2048 bits
\item RSA Padding\+: RSA-\/\+OAEP via PKCS\#7 v2.\+2, RSA-\/\+PSS via PKCS\#7 v1.\+5
\end{DoxyItemize}

\begin{DoxyAuthor}{Author}
Anthony {\itshape ACagliano} Cagliano 

Adam {\itshape beck} Beckingham 

commandblockguy 
\end{DoxyAuthor}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{hashlib_8h_a2841462d8933d0982e3ea13dc5284d7c}\label{hashlib_8h_a2841462d8933d0982e3ea13dc5284d7c}} 
\index{hashlib.h@{hashlib.h}!AES128\_KEYLEN@{AES128\_KEYLEN}}
\index{AES128\_KEYLEN@{AES128\_KEYLEN}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{AES128\_KEYLEN}{AES128\_KEYLEN}}
{\footnotesize\ttfamily \#define AES128\+\_\+\+KEYLEN~16}

Defines the byte-\/length of a 128-\/bit AES key \mbox{\Hypertarget{hashlib_8h_a37ba5c621bf4af2ddcb851e179e21623}\label{hashlib_8h_a37ba5c621bf4af2ddcb851e179e21623}} 
\index{hashlib.h@{hashlib.h}!AES192\_KEYLEN@{AES192\_KEYLEN}}
\index{AES192\_KEYLEN@{AES192\_KEYLEN}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{AES192\_KEYLEN}{AES192\_KEYLEN}}
{\footnotesize\ttfamily \#define AES192\+\_\+\+KEYLEN~24}

Defines the byte-\/length of a 192-\/bit AES key \mbox{\Hypertarget{hashlib_8h_a7bab8a778d065da4cc561f4813994f03}\label{hashlib_8h_a7bab8a778d065da4cc561f4813994f03}} 
\index{hashlib.h@{hashlib.h}!AES256\_KEYLEN@{AES256\_KEYLEN}}
\index{AES256\_KEYLEN@{AES256\_KEYLEN}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{AES256\_KEYLEN}{AES256\_KEYLEN}}
{\footnotesize\ttfamily \#define AES256\+\_\+\+KEYLEN~32}

Defines the byte-\/length of a 256-\/bit AES key \mbox{\Hypertarget{hashlib_8h_afab0742642db9c0609c00bf8a54f386f}\label{hashlib_8h_afab0742642db9c0609c00bf8a54f386f}} 
\index{hashlib.h@{hashlib.h}!AES\_BLOCKSIZE@{AES\_BLOCKSIZE}}
\index{AES\_BLOCKSIZE@{AES\_BLOCKSIZE}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{AES\_BLOCKSIZE}{AES\_BLOCKSIZE}}
{\footnotesize\ttfamily \#define AES\+\_\+\+BLOCKSIZE~16}

Defines the blocksize of the AES cipher. \mbox{\Hypertarget{hashlib_8h_afc06a029c783f78badc2c26cf6f2297c}\label{hashlib_8h_afc06a029c783f78badc2c26cf6f2297c}} 
\index{hashlib.h@{hashlib.h}!AES\_IV\_SIZE@{AES\_IV\_SIZE}}
\index{AES\_IV\_SIZE@{AES\_IV\_SIZE}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{AES\_IV\_SIZE}{AES\_IV\_SIZE}}
{\footnotesize\ttfamily \#define AES\+\_\+\+IV\+\_\+\+SIZE~\mbox{\hyperlink{hashlib_8h_afab0742642db9c0609c00bf8a54f386f}{AES\+\_\+\+BLOCKSIZE}}}

Defines the length of the AES initalization vector (IV). \mbox{\Hypertarget{hashlib_8h_acf32bb8a8d871f4cf33f26c8b2a977fb}\label{hashlib_8h_acf32bb8a8d871f4cf33f26c8b2a977fb}} 
\index{hashlib.h@{hashlib.h}!AES\_MAC\_SIZE@{AES\_MAC\_SIZE}}
\index{AES\_MAC\_SIZE@{AES\_MAC\_SIZE}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{AES\_MAC\_SIZE}{AES\_MAC\_SIZE}}
{\footnotesize\ttfamily \#define AES\+\_\+\+MAC\+\_\+\+SIZE~\mbox{\hyperlink{hashlib_8h_afab0742642db9c0609c00bf8a54f386f}{AES\+\_\+\+BLOCKSIZE}}}

Defines the length of the AES CBC-\/\+MAC digest. \mbox{\Hypertarget{hashlib_8h_a89e00bf4bceabd69cff65a5cbf685bd1}\label{hashlib_8h_a89e00bf4bceabd69cff65a5cbf685bd1}} 
\index{hashlib.h@{hashlib.h}!hashlib\_AESAuthMacCiphertextLen@{hashlib\_AESAuthMacCiphertextLen}}
\index{hashlib\_AESAuthMacCiphertextLen@{hashlib\_AESAuthMacCiphertextLen}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hashlib\_AESAuthMacCiphertextLen}{hashlib\_AESAuthMacCiphertextLen}}
{\footnotesize\ttfamily \#define hashlib\+\_\+\+AESAuth\+Mac\+Ciphertext\+Len(\begin{DoxyParamCaption}\item[{}]{len }\end{DoxyParamCaption})~ (\mbox{\hyperlink{hashlib_8h_a140213b514394151a1d6ba410ec32bc4}{hashlib\+\_\+\+AESCiphertext\+Len}}((len)) + \mbox{\hyperlink{hashlib_8h_acf32bb8a8d871f4cf33f26c8b2a977fb}{AES\+\_\+\+MAC\+\_\+\+SIZE}})}

Defines a macro to return the size of an AES ciphertext with CBC-\/\+MAC authentication.


\begin{DoxyParams}{Parameters}
{\em len} & The length of the plaintext. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
This is the ciphertext length from the previous macro with an additional block for the CBC-\/\+MAC of the ciphertext to be appended. 
\end{DoxyNote}
\mbox{\Hypertarget{hashlib_8h_abc4277e4f58f162b211ca4c2a38c2a5a}\label{hashlib_8h_abc4277e4f58f162b211ca4c2a38c2a5a}} 
\index{hashlib.h@{hashlib.h}!hashlib\_AESAuthSha256CiphertextLen@{hashlib\_AESAuthSha256CiphertextLen}}
\index{hashlib\_AESAuthSha256CiphertextLen@{hashlib\_AESAuthSha256CiphertextLen}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hashlib\_AESAuthSha256CiphertextLen}{hashlib\_AESAuthSha256CiphertextLen}}
{\footnotesize\ttfamily \#define hashlib\+\_\+\+AESAuth\+Sha256\+Ciphertext\+Len(\begin{DoxyParamCaption}\item[{}]{len }\end{DoxyParamCaption})~ (\mbox{\hyperlink{hashlib_8h_a140213b514394151a1d6ba410ec32bc4}{hashlib\+\_\+\+AESCiphertext\+Len}}((len)) + \mbox{\hyperlink{hashlib_8h_af5aa539ae202ddf9e0c9211309869fc8}{SHA256\+\_\+\+DIGEST\+\_\+\+LEN}})}

Defines a macro to return the size of an AES ciphertext with SHA-\/256 authentication.


\begin{DoxyParams}{Parameters}
{\em len} & The length of the plaintext. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
This is the ciphertext length from the previous macro with an additional 32 bytes for the SHA-\/256 of the ciphertext to be appended. 
\end{DoxyNote}
\mbox{\Hypertarget{hashlib_8h_a140213b514394151a1d6ba410ec32bc4}\label{hashlib_8h_a140213b514394151a1d6ba410ec32bc4}} 
\index{hashlib.h@{hashlib.h}!hashlib\_AESCiphertextLen@{hashlib\_AESCiphertextLen}}
\index{hashlib\_AESCiphertextLen@{hashlib\_AESCiphertextLen}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hashlib\_AESCiphertextLen}{hashlib\_AESCiphertextLen}}
{\footnotesize\ttfamily \#define hashlib\+\_\+\+AESCiphertext\+Len(\begin{DoxyParamCaption}\item[{}]{len }\end{DoxyParamCaption})~(\mbox{\hyperlink{hashlib_8h_af7f9757a799b724cfd578ac0a45f58be}{hashlib\+\_\+\+AESPadded\+Size}}((len)) + \mbox{\hyperlink{hashlib_8h_afc06a029c783f78badc2c26cf6f2297c}{AES\+\_\+\+IV\+\_\+\+SIZE}})}

Defines a macro to return the size of an AES ciphertext.


\begin{DoxyParams}{Parameters}
{\em len} & The length of the plaintext. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
This is the padded length of the plaintext, plus an additional block for the IV to be prepended. 
\end{DoxyNote}
\mbox{\Hypertarget{hashlib_8h_a864d96afe89419821aed4293d979b2b9}\label{hashlib_8h_a864d96afe89419821aed4293d979b2b9}} 
\index{hashlib.h@{hashlib.h}!hashlib\_AESKeygen@{hashlib\_AESKeygen}}
\index{hashlib\_AESKeygen@{hashlib\_AESKeygen}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hashlib\_AESKeygen}{hashlib\_AESKeygen}}
{\footnotesize\ttfamily \#define hashlib\+\_\+\+AESKeygen(\begin{DoxyParamCaption}\item[{}]{key,  }\item[{}]{keylen }\end{DoxyParamCaption})~\mbox{\hyperlink{hashlib_8h_aa0092aa4c122591fae447dda8fa25dfc}{hashlib\+\_\+\+Random\+Bytes}}((key), (keylen))}

Defines a macro to generate a pseudorandom AES key of a given length. 
\begin{DoxyParams}{Parameters}
{\em key} & Pointer to a buffer to write the key into. \\
\hline
{\em kelen} & The byte length of the key to generate. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{hashlib_8h_af7f9757a799b724cfd578ac0a45f58be}\label{hashlib_8h_af7f9757a799b724cfd578ac0a45f58be}} 
\index{hashlib.h@{hashlib.h}!hashlib\_AESPaddedSize@{hashlib\_AESPaddedSize}}
\index{hashlib\_AESPaddedSize@{hashlib\_AESPaddedSize}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hashlib\_AESPaddedSize}{hashlib\_AESPaddedSize}}
{\footnotesize\ttfamily \#define hashlib\+\_\+\+AESPadded\+Size(\begin{DoxyParamCaption}\item[{}]{len }\end{DoxyParamCaption})~ ((((len)\%\mbox{\hyperlink{hashlib_8h_afab0742642db9c0609c00bf8a54f386f}{AES\+\_\+\+BLOCKSIZE}})==0) ? (len) + \mbox{\hyperlink{hashlib_8h_afab0742642db9c0609c00bf8a54f386f}{AES\+\_\+\+BLOCKSIZE}} \+: (((len)$>$$>$4) + 1)$<$$<$4)}

Defines a macro to return the padded size of an AES plaintext. 
\begin{DoxyParams}{Parameters}
{\em len} & The length of the plaintext. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{hashlib_8h_a97c7527aa5efe0f229c45c54ebcc6b55}\label{hashlib_8h_a97c7527aa5efe0f229c45c54ebcc6b55}} 
\index{hashlib.h@{hashlib.h}!hashlib\_FastMemBufferSafe@{hashlib\_FastMemBufferSafe}}
\index{hashlib\_FastMemBufferSafe@{hashlib\_FastMemBufferSafe}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hashlib\_FastMemBufferSafe}{hashlib\_FastMemBufferSafe}}
{\footnotesize\ttfamily \#define hashlib\+\_\+\+Fast\+Mem\+Buffer\+Safe~((void$\ast$)0x\+E30\+A04)}

Pointer to a region of Fast Memory that is generally safe to use so long as you don\textquotesingle{}t call Libload.. \begin{DoxyWarning}{Warning}
Fast Memory gets clobbered by Lib\+Load. Don\textquotesingle{}t keep long-\/term storage here if you plan to call Lib\+Load. 
\end{DoxyWarning}
\mbox{\Hypertarget{hashlib_8h_ab981c88a4cd7407b2c4b4bfe86fc021b}\label{hashlib_8h_ab981c88a4cd7407b2c4b4bfe86fc021b}} 
\index{hashlib.h@{hashlib.h}!hashlib\_FastMemBufferUnsafe@{hashlib\_FastMemBufferUnsafe}}
\index{hashlib\_FastMemBufferUnsafe@{hashlib\_FastMemBufferUnsafe}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hashlib\_FastMemBufferUnsafe}{hashlib\_FastMemBufferUnsafe}}
{\footnotesize\ttfamily \#define hashlib\+\_\+\+Fast\+Mem\+Buffer\+Unsafe~((void$\ast$)0x\+E30800)}

Pointer to the start of the region of Fast Memory, including the Safe region as well as an unsafe region used by the library\textquotesingle{}s SPRNG. \begin{DoxyWarning}{Warning}
Fast Memory gets clobbered by Lib\+Load. Don\textquotesingle{}t keep long-\/term storage here if you plan to call Lib\+Load. 

If the SPRNG is run, anything you have stored here will be destroyed. 
\end{DoxyWarning}
\mbox{\Hypertarget{hashlib_8h_ad4ea46d5db12669bb2687771d094638f}\label{hashlib_8h_ad4ea46d5db12669bb2687771d094638f}} 
\index{hashlib.h@{hashlib.h}!hashlib\_MallocContext@{hashlib\_MallocContext}}
\index{hashlib\_MallocContext@{hashlib\_MallocContext}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hashlib\_MallocContext}{hashlib\_MallocContext}}
{\footnotesize\ttfamily \#define hashlib\+\_\+\+Malloc\+Context(\begin{DoxyParamCaption}\item[{}]{size }\end{DoxyParamCaption})~malloc((size))}

Dynamically allocates a block of memory to be used for a context or buffer.


\begin{DoxyParams}{Parameters}
{\em size} & Size of the buffer to malloc. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Same as {\bfseries{malloc}}. 
\end{DoxyReturn}
\mbox{\Hypertarget{hashlib_8h_af5aa539ae202ddf9e0c9211309869fc8}\label{hashlib_8h_af5aa539ae202ddf9e0c9211309869fc8}} 
\index{hashlib.h@{hashlib.h}!SHA256\_DIGEST\_LEN@{SHA256\_DIGEST\_LEN}}
\index{SHA256\_DIGEST\_LEN@{SHA256\_DIGEST\_LEN}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{SHA256\_DIGEST\_LEN}{SHA256\_DIGEST\_LEN}}
{\footnotesize\ttfamily \#define SHA256\+\_\+\+DIGEST\+\_\+\+LEN~32}

Binary length of the SHA-\/256 hash output. \mbox{\Hypertarget{hashlib_8h_a7a767ce32adaa3ad3e7e4aafff0ae7e3}\label{hashlib_8h_a7a767ce32adaa3ad3e7e4aafff0ae7e3}} 
\index{hashlib.h@{hashlib.h}!SHA256\_HEXSTR\_LEN@{SHA256\_HEXSTR\_LEN}}
\index{SHA256\_HEXSTR\_LEN@{SHA256\_HEXSTR\_LEN}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{SHA256\_HEXSTR\_LEN}{SHA256\_HEXSTR\_LEN}}
{\footnotesize\ttfamily \#define SHA256\+\_\+\+HEXSTR\+\_\+\+LEN~(\mbox{\hyperlink{hashlib_8h_af5aa539ae202ddf9e0c9211309869fc8}{SHA256\+\_\+\+DIGEST\+\_\+\+LEN}}$<$$<$1) + 1}

Length of a string containing the SHA-\/256 hash. \mbox{\Hypertarget{hashlib_8h_a939c5eb79064fb776e34fd0c632a588b}\label{hashlib_8h_a939c5eb79064fb776e34fd0c632a588b}} 
\index{hashlib.h@{hashlib.h}!SHA256\_MBUFFER\_LEN@{SHA256\_MBUFFER\_LEN}}
\index{SHA256\_MBUFFER\_LEN@{SHA256\_MBUFFER\_LEN}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{SHA256\_MBUFFER\_LEN}{SHA256\_MBUFFER\_LEN}}
{\footnotesize\ttfamily \#define SHA256\+\_\+\+MBUFFER\+\_\+\+LEN~(64 $\ast$ 4)}

Temporary SHA-\/256 memory buffer. A buffer of this length, in bytes, must be passed to \mbox{\hyperlink{hashlib_8h_ad2fa6bc8d3a1156a5734b81f5195afc4}{hashlib\+\_\+\+Sha256\+Init()}}. 

\doxysubsection{Enumeration Type Documentation}
\mbox{\Hypertarget{hashlib_8h_a5aedfaf159c585059ba8914b59307c21}\label{hashlib_8h_a5aedfaf159c585059ba8914b59307c21}} 
\index{hashlib.h@{hashlib.h}!\_ssl\_sig\_modes@{\_ssl\_sig\_modes}}
\index{\_ssl\_sig\_modes@{\_ssl\_sig\_modes}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{\_ssl\_sig\_modes}{\_ssl\_sig\_modes}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{hashlib_8h_a5aedfaf159c585059ba8914b59307c21}{\+\_\+ssl\+\_\+sig\+\_\+modes}}}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{SSLSIG\_RSA\_SHA256@{SSLSIG\_RSA\_SHA256}!hashlib.h@{hashlib.h}}\index{hashlib.h@{hashlib.h}!SSLSIG\_RSA\_SHA256@{SSLSIG\_RSA\_SHA256}}}\mbox{\Hypertarget{hashlib_8h_a5aedfaf159c585059ba8914b59307c21a096ad031cbdad23c8d4053d9b7a3db31}\label{hashlib_8h_a5aedfaf159c585059ba8914b59307c21a096ad031cbdad23c8d4053d9b7a3db31}} 
SSLSIG\+\_\+\+RSA\+\_\+\+SHA256&RSA with SHA-\/256 signature algorithm \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{SSLSIG\_ECDSA@{SSLSIG\_ECDSA}!hashlib.h@{hashlib.h}}\index{hashlib.h@{hashlib.h}!SSLSIG\_ECDSA@{SSLSIG\_ECDSA}}}\mbox{\Hypertarget{hashlib_8h_a5aedfaf159c585059ba8914b59307c21a3b885e134e618304b93f54b88eff9b25}\label{hashlib_8h_a5aedfaf159c585059ba8914b59307c21a3b885e134e618304b93f54b88eff9b25}} 
SSLSIG\+\_\+\+ECDSA&ECDSA (unimplemented, likely a long way off) \\
\hline

\end{DoxyEnumFields}
\mbox{\Hypertarget{hashlib_8h_a194ef6b5934dff6dceed4dd819e76340}\label{hashlib_8h_a194ef6b5934dff6dceed4dd819e76340}} 
\index{hashlib.h@{hashlib.h}!aes\_cipher\_modes@{aes\_cipher\_modes}}
\index{aes\_cipher\_modes@{aes\_cipher\_modes}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{aes\_cipher\_modes}{aes\_cipher\_modes}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{hashlib_8h_a194ef6b5934dff6dceed4dd819e76340}{aes\+\_\+cipher\+\_\+modes}}}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{AES\_MODE\_CBC@{AES\_MODE\_CBC}!hashlib.h@{hashlib.h}}\index{hashlib.h@{hashlib.h}!AES\_MODE\_CBC@{AES\_MODE\_CBC}}}\mbox{\Hypertarget{hashlib_8h_a194ef6b5934dff6dceed4dd819e76340ad21a3698b98b7368b14ec3d48314a132}\label{hashlib_8h_a194ef6b5934dff6dceed4dd819e76340ad21a3698b98b7368b14ec3d48314a132}} 
AES\+\_\+\+MODE\+\_\+\+CBC&selects CBC mode \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{AES\_MODE\_CTR@{AES\_MODE\_CTR}!hashlib.h@{hashlib.h}}\index{hashlib.h@{hashlib.h}!AES\_MODE\_CTR@{AES\_MODE\_CTR}}}\mbox{\Hypertarget{hashlib_8h_a194ef6b5934dff6dceed4dd819e76340a5ecd63cd0bd97d46f273461b6550cb8e}\label{hashlib_8h_a194ef6b5934dff6dceed4dd819e76340a5ecd63cd0bd97d46f273461b6550cb8e}} 
AES\+\_\+\+MODE\+\_\+\+CTR&selects CTR mode \\
\hline

\end{DoxyEnumFields}
\mbox{\Hypertarget{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3}\label{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3}} 
\index{hashlib.h@{hashlib.h}!aes\_padding\_schemes@{aes\_padding\_schemes}}
\index{aes\_padding\_schemes@{aes\_padding\_schemes}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{aes\_padding\_schemes}{aes\_padding\_schemes}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3}{aes\+\_\+padding\+\_\+schemes}}}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{SCHM\_PKCS7@{SCHM\_PKCS7}!hashlib.h@{hashlib.h}}\index{hashlib.h@{hashlib.h}!SCHM\_PKCS7@{SCHM\_PKCS7}}}\mbox{\Hypertarget{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3a7b7b54293004c0ab7a4a1f6a899e53f2}\label{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3a7b7b54293004c0ab7a4a1f6a899e53f2}} 
SCHM\+\_\+\+PKCS7&PKCS\#7 padding $\vert$ DEFAULT \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{SCHM\_DEFAULT@{SCHM\_DEFAULT}!hashlib.h@{hashlib.h}}\index{hashlib.h@{hashlib.h}!SCHM\_DEFAULT@{SCHM\_DEFAULT}}}\mbox{\Hypertarget{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3a1446879dbb5f2f777c955fcf6723ee4a}\label{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3a1446879dbb5f2f777c955fcf6723ee4a}} 
SCHM\+\_\+\+DEFAULT&selects the scheme marked DEFAULT. Using this is recommended in case a change to the standards would set a stronger padding scheme as default \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{SCHM\_ISO2@{SCHM\_ISO2}!hashlib.h@{hashlib.h}}\index{hashlib.h@{hashlib.h}!SCHM\_ISO2@{SCHM\_ISO2}}}\mbox{\Hypertarget{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3a030a31bd034c7d20a80341ede899a6b7}\label{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3a030a31bd034c7d20a80341ede899a6b7}} 
SCHM\+\_\+\+ISO2&ISO-\/9797 M2 padding \\
\hline

\end{DoxyEnumFields}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{hashlib_8h_a2b904b543405fdf8f283d028ce0d1da7}\label{hashlib_8h_a2b904b543405fdf8f283d028ce0d1da7}} 
\index{hashlib.h@{hashlib.h}!hashlib\_AESDecrypt@{hashlib\_AESDecrypt}}
\index{hashlib\_AESDecrypt@{hashlib\_AESDecrypt}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hashlib\_AESDecrypt()}{hashlib\_AESDecrypt()}}
{\footnotesize\ttfamily bool hashlib\+\_\+\+AESDecrypt (\begin{DoxyParamCaption}\item[{const uint8\+\_\+t $\ast$}]{ciphertext,  }\item[{size\+\_\+t}]{len,  }\item[{uint8\+\_\+t $\ast$}]{plaintext,  }\item[{const \mbox{\hyperlink{struct__aes__ctx}{aes\+\_\+ctx}} $\ast$}]{ks,  }\item[{const uint8\+\_\+t $\ast$}]{iv,  }\item[{uint8\+\_\+t}]{ciphermode }\end{DoxyParamCaption})}



General-\/\+Purpose AES Decryption. 


\begin{DoxyParams}{Parameters}
{\em ciphertext} & Pointer to data to decrypt. \\
\hline
{\em len} & Length of data at\\
\hline
{\em ciphertext} & to decrypt. \\
\hline
{\em plaintext} & Pointer to buffer to write decryped data to. \\
\hline
{\em ks} & Pointer to an AES key schedule context. \\
\hline
{\em iv} & Pointer to an initialization vector (a nonce of length equal to the block size). \\
\hline
{\em ciphermode} & The cipher mode to use. Can be either {\itshape AES\+\_\+\+MODE\+\_\+\+CBC} or {\itshape AES\+\_\+\+MODE\+\_\+\+CTR}. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
{\bfseries{plaintext}} and {\bfseries{ciphertext}} are aliasable. 

{\bfseries{IV}} should be the same as what is used for encryption. 
\end{DoxyNote}
\begin{DoxyReturn}{Returns}
True if the encryption succeded. False if an error occured. 
\end{DoxyReturn}
\mbox{\Hypertarget{hashlib_8h_a5dd423839387f0955b6061986c92a2ac}\label{hashlib_8h_a5dd423839387f0955b6061986c92a2ac}} 
\index{hashlib.h@{hashlib.h}!hashlib\_AESDecryptBlock@{hashlib\_AESDecryptBlock}}
\index{hashlib\_AESDecryptBlock@{hashlib\_AESDecryptBlock}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hashlib\_AESDecryptBlock()}{hashlib\_AESDecryptBlock()}}
{\footnotesize\ttfamily bool hashlib\+\_\+\+AESDecrypt\+Block (\begin{DoxyParamCaption}\item[{const uint8\+\_\+t $\ast$}]{block\+\_\+in,  }\item[{uint8\+\_\+t $\ast$}]{block\+\_\+out,  }\item[{const \mbox{\hyperlink{struct__aes__ctx}{aes\+\_\+ctx}} $\ast$}]{ks }\end{DoxyParamCaption})}



AES Single-\/\+Block Decryption (ECB Mode) 


\begin{DoxyParams}{Parameters}
{\em block\+\_\+in} & Pointer to block of data to decrypt. \\
\hline
{\em block\+\_\+out} & Pointer to buffer to write decrypted block. \\
\hline
{\em ks} & Pointer to an AES key schedule context. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
{\bfseries{block\+\_\+in}} and {\bfseries{block\+\_\+out}} are aliasable. 
\end{DoxyNote}
\begin{DoxyWarning}{Warning}
ECB-\/mode ciphers are insecure (see many-\/time pad vulnerability). These functions are exposed in case a user wants to construct a cipher mode other than CBC or CTR. Unless you know what you are doing, use \mbox{\hyperlink{hashlib_8h_a2b904b543405fdf8f283d028ce0d1da7}{hashlib\+\_\+\+AESDecrypt()}} instead. 
\end{DoxyWarning}
\begin{DoxyReturn}{Returns}
True if encryption succeeded. False if an error occured. 
\end{DoxyReturn}
\mbox{\Hypertarget{hashlib_8h_a745c5c4d6bdc248f20b18c7b848d8b6b}\label{hashlib_8h_a745c5c4d6bdc248f20b18c7b848d8b6b}} 
\index{hashlib.h@{hashlib.h}!hashlib\_AESEncrypt@{hashlib\_AESEncrypt}}
\index{hashlib\_AESEncrypt@{hashlib\_AESEncrypt}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hashlib\_AESEncrypt()}{hashlib\_AESEncrypt()}}
{\footnotesize\ttfamily bool hashlib\+\_\+\+AESEncrypt (\begin{DoxyParamCaption}\item[{const uint8\+\_\+t $\ast$}]{plaintext,  }\item[{size\+\_\+t}]{len,  }\item[{uint8\+\_\+t $\ast$}]{ciphertext,  }\item[{const \mbox{\hyperlink{struct__aes__ctx}{aes\+\_\+ctx}} $\ast$}]{ks,  }\item[{const uint8\+\_\+t $\ast$}]{iv,  }\item[{uint8\+\_\+t}]{ciphermode }\end{DoxyParamCaption})}



General-\/\+Purpose AES Encryption. 


\begin{DoxyParams}{Parameters}
{\em plaintext} & Pointer to data to encrypt. \\
\hline
{\em len} & Length of data at\\
\hline
{\em plaintext} & to encrypt. \\
\hline
{\em ciphertext} & Pointer to buffer to write encrypted data to. \\
\hline
{\em ks} & Pointer to an AES key schedule context. \\
\hline
{\em iv} & Pointer to an initialization vector (a nonce of length equal to the block size). \\
\hline
{\em ciphermode} & The cipher mode to use. Can be either {\itshape AES\+\_\+\+MODE\+\_\+\+CBC} or {\itshape AES\+\_\+\+MODE\+\_\+\+CTR}. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
{\bfseries{plaintext}} and {\bfseries{ciphertext}} are aliasable. 

If cipher mode CBC is used, {\bfseries{len}} must be a multiple of the blocksize. You can pass the plaintext through a padding function prior to calling this function. 
\end{DoxyNote}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{hashlib_8h_aebac98a8537f3353aac9fbae5ed67f29}{hashlib\+\_\+\+AESPad\+Message()}} 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
True if the encryption succeded. False if an error occured. 
\end{DoxyReturn}
\mbox{\Hypertarget{hashlib_8h_a6987499522b3b85b8ce4b272fadf75dd}\label{hashlib_8h_a6987499522b3b85b8ce4b272fadf75dd}} 
\index{hashlib.h@{hashlib.h}!hashlib\_AESEncryptBlock@{hashlib\_AESEncryptBlock}}
\index{hashlib\_AESEncryptBlock@{hashlib\_AESEncryptBlock}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hashlib\_AESEncryptBlock()}{hashlib\_AESEncryptBlock()}}
{\footnotesize\ttfamily bool hashlib\+\_\+\+AESEncrypt\+Block (\begin{DoxyParamCaption}\item[{const uint8\+\_\+t $\ast$}]{block\+\_\+in,  }\item[{uint8\+\_\+t $\ast$}]{block\+\_\+out,  }\item[{const \mbox{\hyperlink{struct__aes__ctx}{aes\+\_\+ctx}} $\ast$}]{ks }\end{DoxyParamCaption})}



AES Single-\/\+Block Encryption (ECB mode) 


\begin{DoxyParams}{Parameters}
{\em block\+\_\+in} & Pointer to block of data to encrypt. \\
\hline
{\em block\+\_\+out} & Pointer to buffer to write encrypted block. \\
\hline
{\em ks} & Pointer to an AES key schedule context. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
{\bfseries{block\+\_\+in}} and {\bfseries{block\+\_\+out}} are aliasable. 
\end{DoxyNote}
\begin{DoxyWarning}{Warning}
ECB-\/mode ciphers are insecure (see many-\/time pad vulnerability). These functions are exposed in case a user wants to construct a cipher mode other than CBC or CTR. Unless you know what you are doing, use \mbox{\hyperlink{hashlib_8h_a745c5c4d6bdc248f20b18c7b848d8b6b}{hashlib\+\_\+\+AESEncrypt()}} instead. 
\end{DoxyWarning}
\begin{DoxyReturn}{Returns}
True if encryption succeeded. False if failed. 
\end{DoxyReturn}
\mbox{\Hypertarget{hashlib_8h_a0653a6a286fb1bedfb3e964d36e3b0bd}\label{hashlib_8h_a0653a6a286fb1bedfb3e964d36e3b0bd}} 
\index{hashlib.h@{hashlib.h}!hashlib\_AESLoadKey@{hashlib\_AESLoadKey}}
\index{hashlib\_AESLoadKey@{hashlib\_AESLoadKey}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hashlib\_AESLoadKey()}{hashlib\_AESLoadKey()}}
{\footnotesize\ttfamily bool hashlib\+\_\+\+AESLoad\+Key (\begin{DoxyParamCaption}\item[{const uint8\+\_\+t $\ast$}]{key,  }\item[{const \mbox{\hyperlink{struct__aes__ctx}{aes\+\_\+ctx}} $\ast$}]{ks,  }\item[{size\+\_\+t}]{keylen }\end{DoxyParamCaption})}



AES import key to key schedule context. 


\begin{DoxyParams}{Parameters}
{\em key} & Pointer to a buffer containing the AES key. \\
\hline
{\em ks} & Pointer to an AES key schedule context. \\
\hline
{\em keylen} & The size, in bytes, of the key to load. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
True if the key was successfully loaded. False otherwise. 
\end{DoxyReturn}
\mbox{\Hypertarget{hashlib_8h_a6ca5ecde1fd675effbc4a29eac35a903}\label{hashlib_8h_a6ca5ecde1fd675effbc4a29eac35a903}} 
\index{hashlib.h@{hashlib.h}!hashlib\_AESOutputMac@{hashlib\_AESOutputMac}}
\index{hashlib\_AESOutputMac@{hashlib\_AESOutputMac}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hashlib\_AESOutputMac()}{hashlib\_AESOutputMac()}}
{\footnotesize\ttfamily bool hashlib\+\_\+\+AESOutput\+Mac (\begin{DoxyParamCaption}\item[{const uint8\+\_\+t $\ast$}]{plaintext,  }\item[{size\+\_\+t}]{len,  }\item[{uint8\+\_\+t $\ast$}]{mac,  }\item[{const \mbox{\hyperlink{struct__aes__ctx}{aes\+\_\+ctx}} $\ast$}]{ks }\end{DoxyParamCaption})}



Returns a message authentication code for an AES message. 

The MAC is a tag equal in length to the AES block size computed by passing the plaintext through the CBC-\/\+MAC algorithm with a constant IV.


\begin{DoxyParams}{Parameters}
{\em plaintext} & Pointer to data to generate a MAC for. \\
\hline
{\em len} & Length of data at\\
\hline
{\em plaintext} & to generate a MAC for. \\
\hline
{\em mac} & Pointer to a buffer to write the MAC to. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
CBC-\/\+MAC requires padding, as it uses CBC mode. You can use the \mbox{\hyperlink{hashlib_8h_aebac98a8537f3353aac9fbae5ed67f29}{hashlib\+\_\+\+AESPad\+Message()}} padding function. Padding mode ISO-\/9791 M2 is preferred for CBC-\/\+MAC, but either can be used. 
\end{DoxyNote}
\begin{DoxyWarning}{Warning}
Do not use the same AES key/key schedule for authentication and encryption. This exposes attack vectors. Use different key schedules. 

For the most secure authenticated encryption scheme, use \char`\"{}encrypt-\/then-\/\+MAC\char`\"{}. This means that you encrypt first, then you return a MAC or hash of the ciphertext and any associated un-\/encrypted metadata (such as the IV). While some authentication schemes do use \char`\"{}\+MAC-\/then-\/encrypt\char`\"{}, there are more attack vectors against that. 
\end{DoxyWarning}
\begin{DoxyReturn}{Returns}
True if the MAC generation succeeded. False if an error occured. 
\end{DoxyReturn}
\mbox{\Hypertarget{hashlib_8h_aebac98a8537f3353aac9fbae5ed67f29}\label{hashlib_8h_aebac98a8537f3353aac9fbae5ed67f29}} 
\index{hashlib.h@{hashlib.h}!hashlib\_AESPadMessage@{hashlib\_AESPadMessage}}
\index{hashlib\_AESPadMessage@{hashlib\_AESPadMessage}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hashlib\_AESPadMessage()}{hashlib\_AESPadMessage()}}
{\footnotesize\ttfamily size\+\_\+t hashlib\+\_\+\+AESPad\+Message (\begin{DoxyParamCaption}\item[{const uint8\+\_\+t $\ast$}]{plaintext,  }\item[{size\+\_\+t}]{len,  }\item[{uint8\+\_\+t $\ast$}]{outbuf,  }\item[{uint8\+\_\+t}]{schm }\end{DoxyParamCaption})}



Pads a plaintext according to the specified AES padding scheme. 


\begin{DoxyParams}{Parameters}
{\em plaintext} & Pointer to buffer containing the data to pad. \\
\hline
{\em len} & Length of data at\\
\hline
{\em plaintext} & to pad. \\
\hline
{\em outbuf} & Pointer to buffer to write padded data. \\
\hline
{\em schm} & The AES padding scheme to use. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
{\bfseries{plaintext}} and {\bfseries{outbuf}} are aliasable. 
\end{DoxyNote}
\begin{DoxyReturn}{Returns}
The padded length of the message. 
\end{DoxyReturn}
\mbox{\Hypertarget{hashlib_8h_a152d6d62f1a21c97a551cea7e6110e59}\label{hashlib_8h_a152d6d62f1a21c97a551cea7e6110e59}} 
\index{hashlib.h@{hashlib.h}!hashlib\_AESStripPadding@{hashlib\_AESStripPadding}}
\index{hashlib\_AESStripPadding@{hashlib\_AESStripPadding}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hashlib\_AESStripPadding()}{hashlib\_AESStripPadding()}}
{\footnotesize\ttfamily size\+\_\+t hashlib\+\_\+\+AESStrip\+Padding (\begin{DoxyParamCaption}\item[{const uint8\+\_\+t $\ast$}]{plaintext,  }\item[{size\+\_\+t}]{len,  }\item[{uint8\+\_\+t $\ast$}]{outbuf,  }\item[{uint8\+\_\+t}]{schm }\end{DoxyParamCaption})}



Strips the padding from a message according to the specified AES padding scheme. 


\begin{DoxyParams}{Parameters}
{\em plaintext} & Pointer to buffer containing the data to strip. \\
\hline
{\em len} & Length of data at\\
\hline
{\em plaintext} & to strip. \\
\hline
{\em outbuf} & Pointer to buffer to write stripped data. \\
\hline
{\em schm} & The AES padding scheme to use. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
{\bfseries{plaintext}} and {\bfseries{outbuf}} are aliasable. 
\end{DoxyNote}
\begin{DoxyReturn}{Returns}
The length of the message with padding removed. 
\end{DoxyReturn}
\mbox{\Hypertarget{hashlib_8h_a658b0b7f7139a429e3b77a9876e78970}\label{hashlib_8h_a658b0b7f7139a429e3b77a9876e78970}} 
\index{hashlib.h@{hashlib.h}!hashlib\_CompareDigest@{hashlib\_CompareDigest}}
\index{hashlib\_CompareDigest@{hashlib\_CompareDigest}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hashlib\_CompareDigest()}{hashlib\_CompareDigest()}}
{\footnotesize\ttfamily hashlib\+\_\+\+Compare\+Digest (\begin{DoxyParamCaption}\item[{const uint8\+\_\+t $\ast$}]{digest1,  }\item[{const uint8\+\_\+t $\ast$}]{digest2,  }\item[{size\+\_\+t}]{len }\end{DoxyParamCaption})}



Secure buffer comparison. 

Evaluates the equality of two buffers using a method that offers resistance to timing attacks.


\begin{DoxyParams}{Parameters}
{\em digest1} & The first buffer to compare. \\
\hline
{\em digest2} & The second buffer to compare. \\
\hline
{\em len} & The number of bytes to compare. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
True if the buffers were equal. False if not equal. 
\end{DoxyReturn}
\mbox{\Hypertarget{hashlib_8h_a24bf91aef912b8346523f37e16d22377}\label{hashlib_8h_a24bf91aef912b8346523f37e16d22377}} 
\index{hashlib.h@{hashlib.h}!hashlib\_EraseContext@{hashlib\_EraseContext}}
\index{hashlib\_EraseContext@{hashlib\_EraseContext}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hashlib\_EraseContext()}{hashlib\_EraseContext()}}
{\footnotesize\ttfamily void hashlib\+\_\+\+Erase\+Context (\begin{DoxyParamCaption}\item[{void $\ast$}]{ctx,  }\item[{size\+\_\+t}]{len }\end{DoxyParamCaption})}



Secure erase context. 


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to any context or buffer you want to erase. \\
\hline
{\em len} & Number of bytes at {\bfseries{ctx}} to erase. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
It is advised to call this on every cryptographic context and encryption buffer used. 
\end{DoxyNote}
\mbox{\Hypertarget{hashlib_8h_a2c1bd7ec5809afead6583128c9052d8b}\label{hashlib_8h_a2c1bd7ec5809afead6583128c9052d8b}} 
\index{hashlib.h@{hashlib.h}!hashlib\_MGF1Hash@{hashlib\_MGF1Hash}}
\index{hashlib\_MGF1Hash@{hashlib\_MGF1Hash}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hashlib\_MGF1Hash()}{hashlib\_MGF1Hash()}}
{\footnotesize\ttfamily void hashlib\+\_\+\+MGF1\+Hash (\begin{DoxyParamCaption}\item[{uint8\+\_\+t $\ast$}]{data,  }\item[{size\+\_\+t}]{datalen,  }\item[{uint8\+\_\+t $\ast$}]{outbuf,  }\item[{size\+\_\+t}]{outlen }\end{DoxyParamCaption})}



Arbitrary Length Hashing Function. 

Computes SHA-\/256 of the data and with a counter appended to generate a hash of arbitrary length.


\begin{DoxyParams}{Parameters}
{\em data} & Pointer to data to hash. \\
\hline
{\em datalen} & Number of bytes at {\bfseries{data}} to hash. \\
\hline
{\em outbuf} & Pointer to buffer to write hash output to. \\
\hline
{\em outlen} & Number of bytes to write to {\bfseries{outbuf}}. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
{\bfseries{outbuf}} must be at least {\bfseries{outlen}} bytes large. 
\end{DoxyNote}
\mbox{\Hypertarget{hashlib_8h_aa0092aa4c122591fae447dda8fa25dfc}\label{hashlib_8h_aa0092aa4c122591fae447dda8fa25dfc}} 
\index{hashlib.h@{hashlib.h}!hashlib\_RandomBytes@{hashlib\_RandomBytes}}
\index{hashlib\_RandomBytes@{hashlib\_RandomBytes}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hashlib\_RandomBytes()}{hashlib\_RandomBytes()}}
{\footnotesize\ttfamily bool hashlib\+\_\+\+Random\+Bytes (\begin{DoxyParamCaption}\item[{uint8\+\_\+t $\ast$}]{buffer,  }\item[{size\+\_\+t}]{size }\end{DoxyParamCaption})}



Fills a buffer to size with random bytes. 


\begin{DoxyParams}{Parameters}
{\em buffer} & A pointer to a buffer to write random data to. \\
\hline
{\em size} & Number of bytes to write. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
{\bfseries{buffer}} must be at least {\bfseries{size}} bytes large. 
\end{DoxyNote}
\mbox{\Hypertarget{hashlib_8h_ae575c99825f9b970c3d6f7a6bf552153}\label{hashlib_8h_ae575c99825f9b970c3d6f7a6bf552153}} 
\index{hashlib.h@{hashlib.h}!hashlib\_RSADecodeOAEP@{hashlib\_RSADecodeOAEP}}
\index{hashlib\_RSADecodeOAEP@{hashlib\_RSADecodeOAEP}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hashlib\_RSADecodeOAEP()}{hashlib\_RSADecodeOAEP()}}
{\footnotesize\ttfamily size\+\_\+t hashlib\+\_\+\+RSADecode\+OAEP (\begin{DoxyParamCaption}\item[{const uint8\+\_\+t $\ast$}]{plaintext,  }\item[{size\+\_\+t}]{len,  }\item[{uint8\+\_\+t $\ast$}]{outbuf,  }\item[{const uint8\+\_\+t $\ast$}]{auth }\end{DoxyParamCaption})}



RSA-\/\+OAEP padding scheme, reverse algorithm. 

Reverses the RSA-\/\+OAEP padding scheme as indicated in PKCS\#1 v2.\+2.


\begin{DoxyParams}{Parameters}
{\em plaintext} & Pointer to a buffer containing the data to OAEP-\/decode. \\
\hline
{\em len} & Length of data at {\bfseries{plaintext}} to decode. \\
\hline
{\em outbuf} & Pointer to buffer large enough to hold the decoded data. \\
\hline
{\em auth} & Pointer to an authentication string (similar to a password) to include in the encoding. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
{\bfseries{outbuf}} must be at least {\bfseries{len-\/34}} bytes large. 

{\bfseries{auth}} Both sender and reciever must know this string if one is provided. Pass NULL to omit. 
\end{DoxyNote}
\begin{DoxyReturn}{Returns}
The decoded length of the plaintext. 
\end{DoxyReturn}
\mbox{\Hypertarget{hashlib_8h_a52c65f6e14ae6287fc2753895ce947be}\label{hashlib_8h_a52c65f6e14ae6287fc2753895ce947be}} 
\index{hashlib.h@{hashlib.h}!hashlib\_RSAEncodeOAEP@{hashlib\_RSAEncodeOAEP}}
\index{hashlib\_RSAEncodeOAEP@{hashlib\_RSAEncodeOAEP}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hashlib\_RSAEncodeOAEP()}{hashlib\_RSAEncodeOAEP()}}
{\footnotesize\ttfamily size\+\_\+t hashlib\+\_\+\+RSAEncode\+OAEP (\begin{DoxyParamCaption}\item[{const uint8\+\_\+t $\ast$}]{plaintext,  }\item[{size\+\_\+t}]{len,  }\item[{uint8\+\_\+t $\ast$}]{outbuf,  }\item[{size\+\_\+t}]{modulus\+\_\+len,  }\item[{const uint8\+\_\+t $\ast$}]{auth }\end{DoxyParamCaption})}



RSA-\/\+OAEP padding scheme. 

Applies the RSA-\/\+OAEP padding scheme as indicated in PKCS\#1 v2.\+2. This is intended for use prior to RSA encryption. 
\begin{DoxyCode}{0}
\DoxyCodeLine{| <-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ modulus size -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/> |}
\DoxyCodeLine{|-\/-\/ 0x00 -\/-\/|-\/-\/ salt -\/-\/|-\/-\/ auth hash -\/-\/|-\/-\/ 0x00...padding -\/-\/|-\/-\/ 0x01 -\/-\/|-\/-\/ message -\/-\/|}
\DoxyCodeLine{           |          |-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|}
\DoxyCodeLine{           |                                       |}
\DoxyCodeLine{           | -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ MGF1-\/SHA256 -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/>XOR}
\DoxyCodeLine{           |                                       |}
\DoxyCodeLine{          XOR <-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ MGF1-\/SHA256 -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|}
\DoxyCodeLine{           |                                       |}
\DoxyCodeLine{|-\/-\/ 0x00 -\/-\/|-\/-\/ msalt -\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ masked message, padding, and auth hash -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|}
\DoxyCodeLine{|<-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ modulus size -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/> |}

\end{DoxyCode}



\begin{DoxyParams}{Parameters}
{\em plaintext} & Pointer to a buffer containing the data to OAEP-\/encode. \\
\hline
{\em len} & Length of data at {\bfseries{plaintext}} to encode. \\
\hline
{\em outbuf} & Pointer to buffer large enough to hold the padded data. \\
\hline
{\em modulus\+\_\+len} & The byte length of the modulus to pad for. \\
\hline
{\em auth} & Pointer to an authentication string (similar to a password) to include in the encoding. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
{\bfseries{outbuf}} must be at least {\bfseries{modulus\+\_\+len}} bytes large. 

{\bfseries{auth}} both sender and receiver must know this string. Pass NULL to omit. 
\end{DoxyNote}
\begin{DoxyReturn}{Returns}
The padded length of the plaintext. 
\end{DoxyReturn}
\mbox{\Hypertarget{hashlib_8h_a01668b3f2dd85fe2f8696673b275b75a}\label{hashlib_8h_a01668b3f2dd85fe2f8696673b275b75a}} 
\index{hashlib.h@{hashlib.h}!hashlib\_RSAEncodePSS@{hashlib\_RSAEncodePSS}}
\index{hashlib\_RSAEncodePSS@{hashlib\_RSAEncodePSS}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hashlib\_RSAEncodePSS()}{hashlib\_RSAEncodePSS()}}
{\footnotesize\ttfamily size\+\_\+t hashlib\+\_\+\+RSAEncode\+PSS (\begin{DoxyParamCaption}\item[{const uint8\+\_\+t $\ast$}]{plaintext,  }\item[{size\+\_\+t}]{len,  }\item[{uint8\+\_\+t $\ast$}]{outbuf,  }\item[{size\+\_\+t}]{modulus\+\_\+len,  }\item[{uint8\+\_\+t $\ast$}]{salt }\end{DoxyParamCaption})}



RSA-\/\+PSS padding scheme. 

Applies the RSA-\/\+PSS padding scheme as indicated in PKCS\#1 v1.\+5. 
\begin{DoxyCode}{0}
\DoxyCodeLine{|-\/ Message -\/|  -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ SHA-\/256 -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/>|}
\DoxyCodeLine{                                                                     |}
\DoxyCodeLine{|-\/-\/ 0x00 padding -\/-\/|-\/-\/ 0x01 -\/-\/|-\/-\/ salt -\/-\/|  |-\/-\/ 8 bytes 0x00 -\/-\/|-\/-\/ mHash -\/-\/|-\/-\/ salt -\/-\/|}
\DoxyCodeLine{|-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|  |-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|}
\DoxyCodeLine{*DB                  |                      *M\textcolor{stringliteral}{'                  |}}
\DoxyCodeLine{\textcolor{stringliteral}{                     |                                        SHA-\/256}}
\DoxyCodeLine{\textcolor{stringliteral}{                    XOR <-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ MGF1-\/SHA256 -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|}}
\DoxyCodeLine{\textcolor{stringliteral}{                     |                                           |}}
\DoxyCodeLine{\textcolor{stringliteral}{                     |                         < -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ |}}
\DoxyCodeLine{\textcolor{stringliteral}{                     |                         |}}
\DoxyCodeLine{\textcolor{stringliteral}{|-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ masked DB -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/ M'} Hash -\/-\/|-\/-\/ 0xbc -\/-\/|}
\DoxyCodeLine{|-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ modulus size -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|}

\end{DoxyCode}



\begin{DoxyParams}{Parameters}
{\em plaintext} & Pointer to buffer containing data to encode. \\
\hline
{\em len} & Length of data at\\
\hline
{\em plaintext} & to encode. \\
\hline
{\em outbuf} & Pointer to buffer to write encoded plaintext to. \\
\hline
{\em modulus\+\_\+len} & The length of the modulus to pad for. \\
\hline
{\em salt} & A buffer filled with random bytes. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
{\bfseries{outbuf}} must be at least {\bfseries{modulus\+\_\+len}} bytes large. 

If you are trying to generate a signature, pass NULL to generate a new salt. 

If you are trying to validate a signature, use hashlib\+\_\+\+SSLVerify\+Signature(). 
\end{DoxyNote}
\begin{DoxyReturn}{Returns}
the padded length of the plaintext. 
\end{DoxyReturn}
\mbox{\Hypertarget{hashlib_8h_a27eda4d2b18a026f199abdcab6d1cc8c}\label{hashlib_8h_a27eda4d2b18a026f199abdcab6d1cc8c}} 
\index{hashlib.h@{hashlib.h}!hashlib\_Sha256Final@{hashlib\_Sha256Final}}
\index{hashlib\_Sha256Final@{hashlib\_Sha256Final}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hashlib\_Sha256Final()}{hashlib\_Sha256Final()}}
{\footnotesize\ttfamily void hashlib\+\_\+\+Sha256\+Final (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct__sha256__ctx}{sha256\+\_\+ctx}} $\ast$}]{ctx,  }\item[{uint8\+\_\+t $\ast$}]{digest }\end{DoxyParamCaption})}



Finalize Context and Render Digest for SHA-\/256. 


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to a SHA-\/256 context. \\
\hline
{\em digest} & Pointer to a buffer to write the hash to. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
{\bfseries{digest}} must be at least 32 bytes large. 
\end{DoxyNote}
\mbox{\Hypertarget{hashlib_8h_ad2fa6bc8d3a1156a5734b81f5195afc4}\label{hashlib_8h_ad2fa6bc8d3a1156a5734b81f5195afc4}} 
\index{hashlib.h@{hashlib.h}!hashlib\_Sha256Init@{hashlib\_Sha256Init}}
\index{hashlib\_Sha256Init@{hashlib\_Sha256Init}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hashlib\_Sha256Init()}{hashlib\_Sha256Init()}}
{\footnotesize\ttfamily void hashlib\+\_\+\+Sha256\+Init (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct__sha256__ctx}{sha256\+\_\+ctx}} $\ast$}]{ctx,  }\item[{uint32\+\_\+t $\ast$}]{mbuffer }\end{DoxyParamCaption})}



Context initializer for SHA-\/256. Initializes the given context with the starting state for SHA-\/256. 


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to a SHA-\/256 context. \\
\hline
{\em mbuffer} & Pointer to a temporary memory buffer. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
{\bfseries{mbuffer}} must be at least {\bfseries{SHA256\+\_\+\+MBUFFER\+\_\+\+LEN}} bytes large. 
\end{DoxyNote}
\mbox{\Hypertarget{hashlib_8h_aeed1dabf7c19464f01c87dcb25a77636}\label{hashlib_8h_aeed1dabf7c19464f01c87dcb25a77636}} 
\index{hashlib.h@{hashlib.h}!hashlib\_Sha256Update@{hashlib\_Sha256Update}}
\index{hashlib\_Sha256Update@{hashlib\_Sha256Update}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hashlib\_Sha256Update()}{hashlib\_Sha256Update()}}
{\footnotesize\ttfamily void hashlib\+\_\+\+Sha256\+Update (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct__sha256__ctx}{sha256\+\_\+ctx}} $\ast$}]{ctx,  }\item[{const uint8\+\_\+t $\ast$}]{buf,  }\item[{uint32\+\_\+t}]{len }\end{DoxyParamCaption})}



Updates the SHA-\/256 context for the given data. 


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to a SHA-\/256 context. \\
\hline
{\em buf} & Pointer to data to hash. \\
\hline
{\em len} & Number of bytes at\\
\hline
{\em buf} & to hash. \\
\hline
\end{DoxyParams}
\begin{DoxyWarning}{Warning}
You must call hashlib\+\_\+\+SHA256\+Init() first or your hash state will be invalid. 
\end{DoxyWarning}
\mbox{\Hypertarget{hashlib_8h_a179d02d08f13b8a2ec239ae3f6fc81de}\label{hashlib_8h_a179d02d08f13b8a2ec239ae3f6fc81de}} 
\index{hashlib.h@{hashlib.h}!hashlib\_SPRNGInit@{hashlib\_SPRNGInit}}
\index{hashlib\_SPRNGInit@{hashlib\_SPRNGInit}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hashlib\_SPRNGInit()}{hashlib\_SPRNGInit()}}
{\footnotesize\ttfamily void$\ast$ hashlib\+\_\+\+SPRNGInit (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Initializes the SPRNG. 

The SPRNG is initialized by polling the 512-\/bytes from address 0x\+D65800 to 0x\+D66000. This region consists of unmapped memory that contains bus noise. Each bit in that region is polled 1024 times and the address with the bit that is the least biased is selected. That will be the byte the SPRNG uses to generate entropy. \begin{DoxyReturn}{Returns}
The unmapped address selected for use generating entropy 
\end{DoxyReturn}
\mbox{\Hypertarget{hashlib_8h_ad4e253aa114047e5a49af2fd49781559}\label{hashlib_8h_ad4e253aa114047e5a49af2fd49781559}} 
\index{hashlib.h@{hashlib.h}!hashlib\_SPRNGRandom@{hashlib\_SPRNGRandom}}
\index{hashlib\_SPRNGRandom@{hashlib\_SPRNGRandom}!hashlib.h@{hashlib.h}}
\doxysubsubsection{\texorpdfstring{hashlib\_SPRNGRandom()}{hashlib\_SPRNGRandom()}}
{\footnotesize\ttfamily uint32\+\_\+t hashlib\+\_\+\+SPRNGRandom (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Generates a random 32-\/bit number. 


\begin{DoxyItemize}
\item Calls \mbox{\hyperlink{hashlib_8h_a179d02d08f13b8a2ec239ae3f6fc81de}{hashlib\+\_\+\+SPRNGInit()}} if it hasn\textquotesingle{}t already been done.
\item Populates a 119-\/byte entropy pool by xor\textquotesingle{}ing 7 distinct reads from the unmapped address together per byte.
\item Hashes the entropy pool using SHA-\/256.
\item Breaks the SHA-\/256 hash into 8-\/byte blocks, then xor\textquotesingle{}s all 8 bytes each block together, leaving four (4) composite bytes.
\item Returns the 4-\/byte (32-\/bit) composite as a random number.. \begin{DoxyReturn}{Returns}
A random unsigned 32-\/bit integer. 
\end{DoxyReturn}

\end{DoxyItemize}