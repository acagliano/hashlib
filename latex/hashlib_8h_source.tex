\hypertarget{hashlib_8h_source}{}\doxysection{hashlib.\+h}
\mbox{\hyperlink{hashlib_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#ifndef HASHLIB\_H}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#define HASHLIB\_H}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include <stdint.h>}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include <stdbool.h>}}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include <stddef.h>}}
\DoxyCodeLine{24 }
\DoxyCodeLine{25 }
\DoxyCodeLine{30 \textcolor{preprocessor}{\#define fastRam\_Safe        ((void*)0xE30A04)}}
\DoxyCodeLine{31  }
\DoxyCodeLine{32 }
\DoxyCodeLine{39 \textcolor{preprocessor}{\#define fastRam\_Unsafe      ((void*)0xE30800)}}
\DoxyCodeLine{40 }
\DoxyCodeLine{41 }
\DoxyCodeLine{42 \textcolor{comment}{/*}}
\DoxyCodeLine{43 \textcolor{comment}{Cryptographically-\/Secure Random Number Generator (CS-\/RNG)}}
\DoxyCodeLine{44 \textcolor{comment}{}}
\DoxyCodeLine{45 \textcolor{comment}{Many of the psuedorandom number generators (PRNGs) you find in computers and}}
\DoxyCodeLine{46 \textcolor{comment}{even the one within the C toolchain for the CE are insecure for cryptographic}}
\DoxyCodeLine{47 \textcolor{comment}{purposes. They produce statistical randomness, but the state is generally seeded}}
\DoxyCodeLine{48 \textcolor{comment}{using a value such as rtc\_Time(). If an adversary reconstructs the seed, every}}
\DoxyCodeLine{49 \textcolor{comment}{output of the PRNG becomes computable with little effort. These types of PRNGs}}
\DoxyCodeLine{50 \textcolor{comment}{are called deterministic algorithms-\/-\/given the input, the output is predictable.}}
\DoxyCodeLine{51 \textcolor{comment}{These PRNGs work for games and other applications where the illusion of randomness}}
\DoxyCodeLine{52 \textcolor{comment}{is sufficient, but they are not safe for cryptography.}}
\DoxyCodeLine{53 \textcolor{comment}{}}
\DoxyCodeLine{54 \textcolor{comment}{A secure PRNG is an random number generator that is not only statistically random, but}}
\DoxyCodeLine{55 \textcolor{comment}{also passes the next-\/bit and state compromise tests. The \_next-\/bit test\_ is defined like so:}}
\DoxyCodeLine{56 \textcolor{comment}{given the prior output of the PRNG (bits 0=>i), the next bit (i+1) of the output cannot be}}
\DoxyCodeLine{57 \textcolor{comment}{predicted by a polynomial-\/time statistical test with a probability non-\/negligibly greater than 50\%.}}
\DoxyCodeLine{58 \textcolor{comment}{In simpler terms, a secure PRNG must be unpredictable, or "{}entropic"{}.}}
\DoxyCodeLine{59 \textcolor{comment}{The \_state compromise test\_ means that an adversary gaining knowledge of the initial state of}}
\DoxyCodeLine{60 \textcolor{comment}{the PRNG does not gain any information about its output.}}
\DoxyCodeLine{61 \textcolor{comment}{}}
\DoxyCodeLine{62 \textcolor{comment}{The SRNG previded by HASHLIB solves both tests like so:}}
\DoxyCodeLine{63 \textcolor{comment}{(next-\/bit)}}
\DoxyCodeLine{64 \textcolor{comment}{    <>  The SRNG's output is derived from a 119-\/byte entropy pool created by reading}}
\DoxyCodeLine{65 \textcolor{comment}{        data from the most entropic byte located within floating memory on the device.}}
\DoxyCodeLine{66 \textcolor{comment}{    <>  The "{}entropic byte"{} is a byte containing a bit that that, out of 1024 test reads,}}
\DoxyCodeLine{67 \textcolor{comment}{        has the closest to a 50/50 split between 1's and 0's.}}
\DoxyCodeLine{68 \textcolor{comment}{    <>  The byte containing that bit is read in xor mode seven times per byte to offset}}
\DoxyCodeLine{69 \textcolor{comment}{        any hardware-\/based correlation between subsequent reads from the entropic byte.}}
\DoxyCodeLine{70 \textcolor{comment}{    <>  The entropy pool is then run through a cryptographic hash to spread that entropy}}
\DoxyCodeLine{71 \textcolor{comment}{        evenly through the returned random value.}}
\DoxyCodeLine{72 \textcolor{comment}{    <>  The SRNG produces 96.51 bits of entropy per 32 bit number returned.}}
\DoxyCodeLine{73 \textcolor{comment}{    <>  Assertion: A source of randomness with sufficient entropy passed through a cryptographic hash}}
\DoxyCodeLine{74 \textcolor{comment}{        will produce output that passes all statistical randomness tests as well as the next-\/bit test.}}
\DoxyCodeLine{75 \textcolor{comment}{(state compromise)}}
\DoxyCodeLine{76 \textcolor{comment}{    <>  The entropy pool is discarded after it is used once, and a new pool is}}
\DoxyCodeLine{77 \textcolor{comment}{        generated for the next random number.}}
\DoxyCodeLine{78 \textcolor{comment}{    <>  \string^ This means that the prior state has no bearing on the next output of the PRNG.}}
\DoxyCodeLine{79 \textcolor{comment}{    <>  The SRNG destroys its own state after the random number is generated so that}}
\DoxyCodeLine{80 \textcolor{comment}{        the state used to generate it does not persist in memory.}}
\DoxyCodeLine{81 \textcolor{comment}{        }}
\DoxyCodeLine{82 \textcolor{comment}{*   Due to the derivation of entropy from subtle variations in the electrical state of}}
\DoxyCodeLine{83 \textcolor{comment}{    unmapped memory, this SRNG can also be considered a \_hardware-\/based RNG\_ (HWRNG).}}
\DoxyCodeLine{84 \textcolor{comment}{*/}}
\DoxyCodeLine{85 }
\DoxyCodeLine{97 \textcolor{keywordtype}{bool} \mbox{\hyperlink{hashlib_8h_a008b7da7adce38b117a17c8165c08df9}{csrand\_init}}(\textcolor{keywordtype}{void});}
\DoxyCodeLine{98 }
\DoxyCodeLine{99 }
\DoxyCodeLine{108 uint32\_t \mbox{\hyperlink{hashlib_8h_a3cdabe638655bf5d3760c4ab700a43fd}{csrand\_get}}(\textcolor{keywordtype}{void});}
\DoxyCodeLine{109 }
\DoxyCodeLine{110 }
\DoxyCodeLine{117 \textcolor{keywordtype}{bool} \mbox{\hyperlink{hashlib_8h_aa3641d44a877ff6eec0eb5cfbfaa5c61}{csrand\_fill}}(\textcolor{keywordtype}{void}* buffer, \textcolor{keywordtype}{size\_t} size);}
\DoxyCodeLine{118  }
\DoxyCodeLine{119  }
\DoxyCodeLine{120 \textcolor{comment}{/*}}
\DoxyCodeLine{121 \textcolor{comment}{Cryptographic Hashes}}
\DoxyCodeLine{122 \textcolor{comment}{ }}
\DoxyCodeLine{123 \textcolor{comment}{A cryptographic hash is used to validate that data is unchanged between two endpoints.}}
\DoxyCodeLine{124 \textcolor{comment}{It is similar to a checksum, but checksums can be easily fooled; cryptographic hashes}}
\DoxyCodeLine{125 \textcolor{comment}{are a lot harder to fool due to how they distribute the bits in a data stream.}}
\DoxyCodeLine{126 \textcolor{comment}{The general use of a hash is as follows: the party sending a message hashes it and}}
\DoxyCodeLine{127 \textcolor{comment}{includes that hash as part of the message. The recipient hashes the message (except the hash)}}
\DoxyCodeLine{128 \textcolor{comment}{themselves and then compares that hash to the one included in the message. If the hashes match,}}
\DoxyCodeLine{129 \textcolor{comment}{the message is complete and unaltered. If the hashes do not match, the message is incomplete}}
\DoxyCodeLine{130 \textcolor{comment}{or has been tampered with.}}
\DoxyCodeLine{131 \textcolor{comment}{*/}}
\DoxyCodeLine{132 }
\DoxyCodeLine{137 \textcolor{keyword}{typedef} \textcolor{keyword}{struct }\mbox{\hyperlink{struct__sha256__ctx}{\_sha256\_ctx}} \{}
\DoxyCodeLine{138     uint8\_t \mbox{\hyperlink{struct__sha256__ctx_a8a53e5a4c3961ca51a4381f6488d1089}{data}}[64];       }
\DoxyCodeLine{139     uint8\_t \mbox{\hyperlink{struct__sha256__ctx_aecfb5410e142575871d537dc00b9d63a}{datalen}};     }
\DoxyCodeLine{140     uint8\_t \mbox{\hyperlink{struct__sha256__ctx_afc9083f7e21cf81eec33df4a5f812b95}{bitlen}}[8];        }
\DoxyCodeLine{141     uint32\_t \mbox{\hyperlink{struct__sha256__ctx_a1e85694ce7e43ed85c5e0f8e11116d18}{state}}[8];     }
\DoxyCodeLine{142 \} \mbox{\hyperlink{hashlib_8h_a53df9e7d871973d59c7b58a6c3963c5d}{sha256\_ctx}};}
\DoxyCodeLine{143 }
\DoxyCodeLine{144 }
\DoxyCodeLine{150 \textcolor{keyword}{typedef} \textcolor{keyword}{struct }\mbox{\hyperlink{struct__hash__ctx}{\_hash\_ctx}} \{}
\DoxyCodeLine{151     bool (*\mbox{\hyperlink{struct__hash__ctx_ae2a5b349e1492dd574ad15829efac848}{fn\_init}})(\textcolor{keywordtype}{void}* ctx);                                     }
\DoxyCodeLine{152     void (*\mbox{\hyperlink{struct__hash__ctx_ab66487a1d47ec5582fe00d8fa14c744e}{fn\_update}})(\textcolor{keywordtype}{void}* ctx, \textcolor{keyword}{const} \textcolor{keywordtype}{void}* data, \textcolor{keywordtype}{size\_t} len);     }
\DoxyCodeLine{153     void (*\mbox{\hyperlink{struct__hash__ctx_ab61f7c829cebf472eec0a80f31e5d66a}{fn\_final}})(\textcolor{keywordtype}{void}* ctx, \textcolor{keywordtype}{void}* output);                      }
\DoxyCodeLine{154     \textcolor{keyword}{union }\mbox{\hyperlink{union__hash__ctx_1_1__hash}{\_hash}} \{           }
\DoxyCodeLine{155         \mbox{\hyperlink{struct__sha256__ctx}{sha256\_ctx}} \mbox{\hyperlink{union__hash__ctx_1_1__hash_ad2426569cf1b106bbbfd1ce4e938ec74}{sha256}};}
\DoxyCodeLine{156     \} Hash;}
\DoxyCodeLine{157 \} \mbox{\hyperlink{hashlib_8h_aa55779911de10df960d64966c6825da7}{hash\_ctx}};}
\DoxyCodeLine{158  }
\DoxyCodeLine{159 }
\DoxyCodeLine{164 \textcolor{keyword}{enum} \mbox{\hyperlink{hashlib_8h_af36e91f131f610a6612b78700d483bd7}{hash\_algorithms}} \{}
\DoxyCodeLine{165     \mbox{\hyperlink{hashlib_8h_af36e91f131f610a6612b78700d483bd7ac7716785728694693ec29eccd5ffa0e1}{SHA256}},             }
\DoxyCodeLine{166 \};}
\DoxyCodeLine{167 }
\DoxyCodeLine{168 }
\DoxyCodeLine{172 \textcolor{preprocessor}{\#define SHA256\_DIGEST\_LEN   32}}
\DoxyCodeLine{173 }
\DoxyCodeLine{174 }
\DoxyCodeLine{182 \textcolor{keywordtype}{bool} \mbox{\hyperlink{hashlib_8h_ac97f2b17187bed64cb75d98ebb9184f8}{hash\_init}}(\mbox{\hyperlink{struct__hash__ctx}{hash\_ctx}}* ctx, uint8\_t hash\_alg);}
\DoxyCodeLine{183 }
\DoxyCodeLine{184 }
\DoxyCodeLine{191 \textcolor{keywordtype}{void} \mbox{\hyperlink{hashlib_8h_aaf0fab49f90f31ca034e68c83858d14e}{hash\_update}}(\mbox{\hyperlink{struct__hash__ctx}{hash\_ctx}}* ctx, \textcolor{keyword}{const} \textcolor{keywordtype}{void}* data, \textcolor{keywordtype}{size\_t} len);}
\DoxyCodeLine{192 }
\DoxyCodeLine{193 }
\DoxyCodeLine{200 \textcolor{keywordtype}{void} \mbox{\hyperlink{hashlib_8h_a6de2a3ef1df7da45fbe84b38f72baa71}{hash\_final}}(\mbox{\hyperlink{struct__hash__ctx}{hash\_ctx}}* ctx, \textcolor{keywordtype}{void}* digest);}
\DoxyCodeLine{201 }
\DoxyCodeLine{202 }
\DoxyCodeLine{214 \textcolor{keywordtype}{bool} \mbox{\hyperlink{hashlib_8h_aef7b1868edb022ce92f850e6269a2db9}{hash\_mgf1}}(\textcolor{keyword}{const} \textcolor{keywordtype}{void}* data, \textcolor{keywordtype}{size\_t} datalen, \textcolor{keywordtype}{void}* outbuf, \textcolor{keywordtype}{size\_t} outlen, uint8\_t hash\_alg);}
\DoxyCodeLine{215 }
\DoxyCodeLine{216 }
\DoxyCodeLine{217 \textcolor{comment}{/*}}
\DoxyCodeLine{218 \textcolor{comment}{SHA-\/256 HMAC Cryptographic Hash (Hash-\/Based Message Authentication Code)}}
\DoxyCodeLine{219 \textcolor{comment}{}}
\DoxyCodeLine{220 \textcolor{comment}{HMAC generates a more secure hash by using a key known only to authorized}}
\DoxyCodeLine{221 \textcolor{comment}{parties as part of the hash initialization. Thus, while normal SHA-\/256 can be}}
\DoxyCodeLine{222 \textcolor{comment}{verified by anyone, only the parties with the key can validate using a HMAC hash.}}
\DoxyCodeLine{223 \textcolor{comment}{*/}}
\DoxyCodeLine{224 }
\DoxyCodeLine{225 }
\DoxyCodeLine{230 \textcolor{keyword}{typedef} \textcolor{keyword}{struct }\mbox{\hyperlink{struct__sha256hmac__ctx}{\_sha256hmac\_ctx}} \{}
\DoxyCodeLine{231     uint8\_t \mbox{\hyperlink{struct__sha256hmac__ctx_ab5acc050668c737d90c0190e75e4b352}{ipad}}[64];       }
\DoxyCodeLine{232     uint8\_t \mbox{\hyperlink{struct__sha256hmac__ctx_aa053a464b6af9c46df33453265de483a}{opad}}[64];       }
\DoxyCodeLine{233     uint8\_t \mbox{\hyperlink{struct__sha256hmac__ctx_af9cbeb1f5ab59ca10aa43df46a1b59e8}{data}}[64];       }
\DoxyCodeLine{234     uint8\_t \mbox{\hyperlink{struct__sha256hmac__ctx_a5ac8daad74cbf5588d512cf49892d2bd}{datalen}};     }
\DoxyCodeLine{235     uint8\_t \mbox{\hyperlink{struct__sha256hmac__ctx_af4fd1738729663cfa87e8a35dbfa7afa}{bitlen}}[8];        }
\DoxyCodeLine{236     uint32\_t \mbox{\hyperlink{struct__sha256hmac__ctx_a27f566f7a597a1c683c3d30805b2f916}{state}}[8];     }
\DoxyCodeLine{237 \} \mbox{\hyperlink{hashlib_8h_ab81b988d5afe79799b52a0baa55c3146}{sha256hmac\_ctx}};}
\DoxyCodeLine{238 }
\DoxyCodeLine{239 }
\DoxyCodeLine{244 \textcolor{keyword}{typedef} \textcolor{keyword}{struct }\mbox{\hyperlink{struct__hmac__ctx}{\_hmac\_ctx}} \{}
\DoxyCodeLine{245     bool (*\mbox{\hyperlink{struct__hmac__ctx_a5592808d47dd58dc8844e41d0062075d}{fn\_init}})(\textcolor{keywordtype}{void}* ctx, \textcolor{keyword}{const} \textcolor{keywordtype}{void}* key, \textcolor{keywordtype}{size\_t} keylen);     }
\DoxyCodeLine{246     void (*\mbox{\hyperlink{struct__hmac__ctx_ae32d4143aef63d76e96ad9f88af14f94}{fn\_update}})(\textcolor{keywordtype}{void}* ctx, \textcolor{keyword}{const} \textcolor{keywordtype}{void}* data, \textcolor{keywordtype}{size\_t} len);     }
\DoxyCodeLine{247     void (*\mbox{\hyperlink{struct__hmac__ctx_a489e319d3ffa62e6c77f950c2c6ecc43}{fn\_final}})(\textcolor{keywordtype}{void}* ctx, \textcolor{keywordtype}{void}* output);                      }
\DoxyCodeLine{248     \textcolor{keyword}{union }\mbox{\hyperlink{union__hmac__ctx_1_1__hmac}{\_hmac}} \{           }
\DoxyCodeLine{249         \mbox{\hyperlink{struct__sha256hmac__ctx}{sha256hmac\_ctx}} \mbox{\hyperlink{union__hmac__ctx_1_1__hmac_a79f9ff1e4e50e87d2b7b2fafea176789}{sha256hmac}};}
\DoxyCodeLine{250     \} Hmac;}
\DoxyCodeLine{251 \} \mbox{\hyperlink{hashlib_8h_a8d813300476744f01319600478572f62}{hmac\_ctx}};}
\DoxyCodeLine{252 }
\DoxyCodeLine{253 }
\DoxyCodeLine{263 \textcolor{keywordtype}{bool} \mbox{\hyperlink{hashlib_8h_a898e128b3311035c6769837208f34a7d}{hmac\_init}}(\mbox{\hyperlink{struct__hmac__ctx}{hmac\_ctx}}* ctx, \textcolor{keyword}{const} \textcolor{keywordtype}{void}* key, \textcolor{keywordtype}{size\_t} keylen, uint8\_t hash\_alg);}
\DoxyCodeLine{264 }
\DoxyCodeLine{265 }
\DoxyCodeLine{272 \textcolor{keywordtype}{void} \mbox{\hyperlink{hashlib_8h_a6c5035021e844e83e062c198db85c20e}{hmac\_update}}(\mbox{\hyperlink{struct__hmac__ctx}{hmac\_ctx}}* ctx, \textcolor{keyword}{const} \textcolor{keywordtype}{void}* data, \textcolor{keywordtype}{size\_t} len);}
\DoxyCodeLine{273 }
\DoxyCodeLine{274 }
\DoxyCodeLine{281 \textcolor{keywordtype}{void} \mbox{\hyperlink{hashlib_8h_aab1ccbb4d4cc9b02116d2ed07a5c9ed3}{hmac\_final}}(\mbox{\hyperlink{struct__hmac__ctx}{hmac\_ctx}}* ctx, \textcolor{keywordtype}{void}* output);}
\DoxyCodeLine{282 }
\DoxyCodeLine{283 }
\DoxyCodeLine{302 \textcolor{keywordtype}{bool} \mbox{\hyperlink{hashlib_8h_a1db040f9b150deacb5fca66d4684fa91}{hmac\_pbkdf2}}(}
\DoxyCodeLine{303     \textcolor{keyword}{const} \textcolor{keywordtype}{char}* password,}
\DoxyCodeLine{304     \textcolor{keywordtype}{size\_t} passlen,}
\DoxyCodeLine{305     \textcolor{keywordtype}{void}* key,}
\DoxyCodeLine{306     \textcolor{keywordtype}{size\_t} keylen,}
\DoxyCodeLine{307     \textcolor{keyword}{const} \textcolor{keywordtype}{void}* salt,}
\DoxyCodeLine{308     \textcolor{keywordtype}{size\_t} saltlen,}
\DoxyCodeLine{309     \textcolor{keywordtype}{size\_t} rounds,}
\DoxyCodeLine{310     uint8\_t hash\_alg);}
\DoxyCodeLine{311 }
\DoxyCodeLine{312 }
\DoxyCodeLine{313 \textcolor{comment}{/*}}
\DoxyCodeLine{314 \textcolor{comment}{Advanced Encryption Standard (AES)}}
\DoxyCodeLine{315 \textcolor{comment}{ }}
\DoxyCodeLine{316 \textcolor{comment}{AES is a form of symmetric encryption, and also is a form of block cipher.}}
\DoxyCodeLine{317 \textcolor{comment}{Symmetric encryption means that the same key works in both directions.}}
\DoxyCodeLine{318 \textcolor{comment}{A block cipher is an encryption algorithm that operates on data in segments (for AES, 16 bytes),}}
\DoxyCodeLine{319 \textcolor{comment}{moving through it one segment at a time.}}
\DoxyCodeLine{320 \textcolor{comment}{ }}
\DoxyCodeLine{321 \textcolor{comment}{Symmetric encryption is usually fast, and is generally more secure for smaller key sizes.}}
\DoxyCodeLine{322 \textcolor{comment}{AES is one of the most secure encryption systems in use today.}}
\DoxyCodeLine{323 \textcolor{comment}{The most secure version of the algorithm is AES-\/256 (uses a 256-\/bit key).}}
\DoxyCodeLine{324 \textcolor{comment}{AES is one of the open-\/source encryption schemes believed secure enough to withstand even}}
\DoxyCodeLine{325 \textcolor{comment}{the advent of quantum computing.}}
\DoxyCodeLine{326 \textcolor{comment}{*/}}
\DoxyCodeLine{327 }
\DoxyCodeLine{331 \textcolor{keyword}{typedef} \textcolor{keyword}{struct }\mbox{\hyperlink{struct__aes__ctx}{\_aes\_ctx}} \{}
\DoxyCodeLine{332     uint24\_t \mbox{\hyperlink{struct__aes__ctx_a3c7170b46d94b5b8395f74eb0baa14c8}{keysize}};                }
\DoxyCodeLine{333     uint32\_t \mbox{\hyperlink{struct__aes__ctx_adb6943e9b2c5dd39e5390f26ae470ffe}{round\_keys}}[60];      }
\DoxyCodeLine{334 \} \mbox{\hyperlink{hashlib_8h_aa188bc2768a3b7aa6ad73cb2c77819e0}{aes\_ctx}};}
\DoxyCodeLine{335 }
\DoxyCodeLine{336 }
\DoxyCodeLine{340 \textcolor{keyword}{enum} \mbox{\hyperlink{hashlib_8h_a194ef6b5934dff6dceed4dd819e76340}{aes\_cipher\_modes}} \{}
\DoxyCodeLine{341     \mbox{\hyperlink{hashlib_8h_a194ef6b5934dff6dceed4dd819e76340ad21a3698b98b7368b14ec3d48314a132}{AES\_MODE\_CBC}},       }
\DoxyCodeLine{342     \mbox{\hyperlink{hashlib_8h_a194ef6b5934dff6dceed4dd819e76340a5ecd63cd0bd97d46f273461b6550cb8e}{AES\_MODE\_CTR}}        }
\DoxyCodeLine{343 \};}
\DoxyCodeLine{344 }
\DoxyCodeLine{345 }
\DoxyCodeLine{349 \textcolor{keyword}{enum} \mbox{\hyperlink{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3}{aes\_padding\_schemes}} \{}
\DoxyCodeLine{350     \mbox{\hyperlink{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3a7b7b54293004c0ab7a4a1f6a899e53f2}{SCHM\_PKCS7}},               }
\DoxyCodeLine{351     \mbox{\hyperlink{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3a1446879dbb5f2f777c955fcf6723ee4a}{SCHM\_DEFAULT}} = \mbox{\hyperlink{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3a7b7b54293004c0ab7a4a1f6a899e53f2}{SCHM\_PKCS7}},    }
\DoxyCodeLine{354     \mbox{\hyperlink{hashlib_8h_a9933dec76c43b37331782bdd16ebc4a3a030a31bd034c7d20a80341ede899a6b7}{SCHM\_ISO2}},             }
\DoxyCodeLine{355 \};}
\DoxyCodeLine{356 }
\DoxyCodeLine{357 }
\DoxyCodeLine{358 }
\DoxyCodeLine{362 \textcolor{preprocessor}{\#define AES\_BLOCKSIZE   16}}
\DoxyCodeLine{363 }
\DoxyCodeLine{364 }
\DoxyCodeLine{368 \textcolor{preprocessor}{\#define AES\_IVSIZE      AES\_BLOCKSIZE}}
\DoxyCodeLine{369 }
\DoxyCodeLine{370 }
\DoxyCodeLine{378 \textcolor{preprocessor}{\#define aes\_outsize(len) \(\backslash\)}}
\DoxyCodeLine{379 \textcolor{preprocessor}{    ((((len)\%AES\_BLOCKSIZE)==0) ? (len) + AES\_BLOCKSIZE : (((len)>>4) + 1)<<4)}}
\DoxyCodeLine{380     }
\DoxyCodeLine{381 }
\DoxyCodeLine{388 \textcolor{preprocessor}{\#define aes\_extoutsize(len) \(\backslash\)}}
\DoxyCodeLine{389 \textcolor{preprocessor}{    (aes\_outsize((len)) + AES\_IVSIZE)}}
\DoxyCodeLine{390 }
\DoxyCodeLine{391 }
\DoxyCodeLine{399 \textcolor{keywordtype}{bool} \mbox{\hyperlink{hashlib_8h_a3e30c60856defd404e80441ee159aa8b}{aes\_init}}(\textcolor{keyword}{const} \textcolor{keywordtype}{void}* key, \textcolor{keyword}{const} \mbox{\hyperlink{struct__aes__ctx}{aes\_ctx}}* ks, \textcolor{keywordtype}{size\_t} keylen);}
\DoxyCodeLine{400 }
\DoxyCodeLine{401 }
\DoxyCodeLine{406 \textcolor{keyword}{typedef} \textcolor{keyword}{enum} \{}
\DoxyCodeLine{407     \mbox{\hyperlink{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfdaacf07636102724d2a7913911b0cf74b2}{AES\_OK}},                             }
\DoxyCodeLine{408     \mbox{\hyperlink{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfda6d39b280aea9d8d62d126eef05d271db}{AES\_INVALID\_ARG}},                    }
\DoxyCodeLine{409     \mbox{\hyperlink{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfdaae5e9a591aeda666b0e425d9a05834e3}{AES\_INVALID\_MSG}},                    }
\DoxyCodeLine{410     \mbox{\hyperlink{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfdad2b49ffeabf14aaf47db3d1bad18f84e}{AES\_INVALID\_CIPHERMODE}},             }
\DoxyCodeLine{411     \mbox{\hyperlink{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfda47bbd593fc3bdb7758a790bab86b41d9}{AES\_INVALID\_PADDINGMODE}},            }
\DoxyCodeLine{412     \mbox{\hyperlink{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfdaba928751c773ffa0287e47e1f86eae8b}{AES\_INVALID\_CIPHERTEXT}}              }
\DoxyCodeLine{413 \} \mbox{\hyperlink{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfd}{aes\_error\_t}};}
\DoxyCodeLine{414 }
\DoxyCodeLine{415 }
\DoxyCodeLine{441 \mbox{\hyperlink{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfd}{aes\_error\_t}} \mbox{\hyperlink{hashlib_8h_aae223cd681fbba1e0d748b64cfd3e6d3}{aes\_encrypt}}(}
\DoxyCodeLine{442     \textcolor{keyword}{const} \textcolor{keywordtype}{void}* plaintext,}
\DoxyCodeLine{443     \textcolor{keywordtype}{size\_t} len,}
\DoxyCodeLine{444     \textcolor{keywordtype}{void}* ciphertext,}
\DoxyCodeLine{445     \textcolor{keyword}{const} \mbox{\hyperlink{struct__aes__ctx}{aes\_ctx}}* ks,}
\DoxyCodeLine{446     \textcolor{keyword}{const} \textcolor{keywordtype}{void}* iv,}
\DoxyCodeLine{447     uint8\_t ciphermode,}
\DoxyCodeLine{448     uint8\_t paddingmode);}
\DoxyCodeLine{449 }
\DoxyCodeLine{450 }
\DoxyCodeLine{463 \mbox{\hyperlink{hashlib_8h_aeb2e64abcc4317e3143fb820f21c3bfd}{aes\_error\_t}} \mbox{\hyperlink{hashlib_8h_a9167498ff02e1c99d730481e94106fd6}{aes\_decrypt}}(}
\DoxyCodeLine{464     \textcolor{keyword}{const} \textcolor{keywordtype}{void}* ciphertext,}
\DoxyCodeLine{465     \textcolor{keywordtype}{size\_t} len,}
\DoxyCodeLine{466     \textcolor{keywordtype}{void}* plaintext,}
\DoxyCodeLine{467     \textcolor{keyword}{const} \mbox{\hyperlink{struct__aes__ctx}{aes\_ctx}}* ks,}
\DoxyCodeLine{468     \textcolor{keyword}{const} \textcolor{keywordtype}{void}* iv,}
\DoxyCodeLine{469     uint8\_t ciphermode,}
\DoxyCodeLine{470     uint8\_t paddingmode);}
\DoxyCodeLine{471 }
\DoxyCodeLine{472 \textcolor{comment}{/*}}
\DoxyCodeLine{473 \textcolor{comment}{ RSA Public Key Encryption}}
\DoxyCodeLine{474 \textcolor{comment}{ }}
\DoxyCodeLine{475 \textcolor{comment}{ Public key encryption is a form of asymmetric encryption.}}
\DoxyCodeLine{476 \textcolor{comment}{ This means that a key only works in one direction, and both parties need a public key}}
\DoxyCodeLine{477 \textcolor{comment}{ and a private key. The private key is used to decrypt a message and the public key is}}
\DoxyCodeLine{478 \textcolor{comment}{ used to encrypt.}}
\DoxyCodeLine{479 \textcolor{comment}{ In RSA, the public and private keys are modular inverses of each other, such that:}}
\DoxyCodeLine{480 \textcolor{comment}{ encrypted = message ** public exponent \% public key, and}}
\DoxyCodeLine{481 \textcolor{comment}{ message = encrypted ** private exponent \% private modulus}}
\DoxyCodeLine{482 \textcolor{comment}{ ** means power, \% means modulus}}
\DoxyCodeLine{483 \textcolor{comment}{ }}
\DoxyCodeLine{484 \textcolor{comment}{ 65537 (and a few other Fermat primes) are commonly used as public exponents.}}
\DoxyCodeLine{485 \textcolor{comment}{ The public key (modulus) is sent in the clear and is known to to everyone.}}
\DoxyCodeLine{486 \textcolor{comment}{ The cryptographic strength of RSA comes from the difficulty of factoring the modulus.}}
\DoxyCodeLine{487 \textcolor{comment}{ Asymmetric encryption is generally VERY slow. Using even RSA-\/1024 on the TI-\/84+ CE will}}
\DoxyCodeLine{488 \textcolor{comment}{ take several seconds. For this reason, you usually do not use RSA for sustained encrypted}}
\DoxyCodeLine{489 \textcolor{comment}{ communication. Use RSA to share a symmetric key, and then use AES for future messages.}}
\DoxyCodeLine{490 \textcolor{comment}{ }}
\DoxyCodeLine{491 \textcolor{comment}{ */}}
\DoxyCodeLine{492 }
\DoxyCodeLine{493 }
\DoxyCodeLine{497 \textcolor{keyword}{typedef} \textcolor{keyword}{enum} \{}
\DoxyCodeLine{498     \mbox{\hyperlink{hashlib_8h_a0486449f609d0e485bad091a671d9294a2cafdb683e1870a33bcb821420626cae}{RSA\_OK}},                         }
\DoxyCodeLine{499     \mbox{\hyperlink{hashlib_8h_a0486449f609d0e485bad091a671d9294aab9ab38286c4180a1aa9f6e8df42e5db}{RSA\_INVALID\_ARG}},                }
\DoxyCodeLine{500     \mbox{\hyperlink{hashlib_8h_a0486449f609d0e485bad091a671d9294aedeb18a96b96e292369abed5b2f0a271}{RSA\_INVALID\_MSG}},                }
\DoxyCodeLine{501     \mbox{\hyperlink{hashlib_8h_a0486449f609d0e485bad091a671d9294a843ec210de66176ef63e2d2b8ebdeb65}{RSA\_INVALID\_MODULUS}},            }
\DoxyCodeLine{502     \mbox{\hyperlink{hashlib_8h_a0486449f609d0e485bad091a671d9294a43eadc89540121b902e02afabc7a7eb9}{RSA\_ENCODING\_ERROR}}              }
\DoxyCodeLine{503 \} \mbox{\hyperlink{hashlib_8h_a0486449f609d0e485bad091a671d9294}{rsa\_error\_t}};}
\DoxyCodeLine{504  }
\DoxyCodeLine{505 }
\DoxyCodeLine{524 \mbox{\hyperlink{hashlib_8h_a0486449f609d0e485bad091a671d9294}{rsa\_error\_t}} \mbox{\hyperlink{hashlib_8h_a993f15527e86e09be9954a7377909e14}{rsa\_encrypt}}(}
\DoxyCodeLine{525     \textcolor{keyword}{const} \textcolor{keywordtype}{void}* msg,}
\DoxyCodeLine{526     \textcolor{keywordtype}{size\_t} msglen,}
\DoxyCodeLine{527     \textcolor{keywordtype}{void}* ciphertext,}
\DoxyCodeLine{528     \textcolor{keyword}{const} \textcolor{keywordtype}{void}* pubkey,}
\DoxyCodeLine{529     \textcolor{keywordtype}{size\_t} keylen,}
\DoxyCodeLine{530     uint8\_t oaep\_hash\_alg);}
\DoxyCodeLine{531     }
\DoxyCodeLine{532 }
\DoxyCodeLine{533 \textcolor{comment}{// Miscellaneous Functions}}
\DoxyCodeLine{534 }
\DoxyCodeLine{535 }
\DoxyCodeLine{541 \textcolor{keywordtype}{bool} \mbox{\hyperlink{hashlib_8h_a9875035ce2ae4859b39cfbbff2d1f609}{digest\_tostring}}(\textcolor{keyword}{const} \textcolor{keywordtype}{void}* digest, \textcolor{keywordtype}{size\_t} len, \textcolor{keywordtype}{char}* hexstr);}
\DoxyCodeLine{542 }
\DoxyCodeLine{543 }
\DoxyCodeLine{544 }
\DoxyCodeLine{554 \textcolor{keywordtype}{bool} \mbox{\hyperlink{hashlib_8h_aade3753b2b7e59ebf301c1c0712f8376}{digest\_compare}}(\textcolor{keyword}{const} \textcolor{keywordtype}{void}* digest1, \textcolor{keyword}{const} \textcolor{keywordtype}{void}* digest2, \textcolor{keywordtype}{size\_t} len);}
\DoxyCodeLine{555 }
\DoxyCodeLine{556 }
\DoxyCodeLine{557 \textcolor{preprocessor}{\#ifdef HASHLIB\_ENABLE\_ADVANCED\_MODE}}
\DoxyCodeLine{558 }
\DoxyCodeLine{559 \textcolor{comment}{/*}}
\DoxyCodeLine{560 \textcolor{comment}{    \#\#\#\# INTERNAL FUNCTIONS \#\#\#\#}}
\DoxyCodeLine{561 \textcolor{comment}{    For advanced users only!!!}}
\DoxyCodeLine{562 \textcolor{comment}{    }}
\DoxyCodeLine{563 \textcolor{comment}{    To enable advanced mode place the directive:}}
\DoxyCodeLine{564 \textcolor{comment}{        \#define HASHLIB\_ENABLE\_ADVANCED\_MODE}}
\DoxyCodeLine{565 \textcolor{comment}{    above any inclusion of this header file.}}
\DoxyCodeLine{566 \textcolor{comment}{    }}
\DoxyCodeLine{567 \textcolor{comment}{    If you know what you are doing and want to implement your own cipher modes,}}
\DoxyCodeLine{568 \textcolor{comment}{    or signature algorithms, a few internal functions are exposed here.}}
\DoxyCodeLine{569 \textcolor{comment}{ */}}
\DoxyCodeLine{570  }
\DoxyCodeLine{571 }
\DoxyCodeLine{580  \textcolor{keywordtype}{void} aes\_ecb\_unsafe\_encrypt(\textcolor{keyword}{const} \textcolor{keywordtype}{void} *block\_in, \textcolor{keywordtype}{void} *block\_out, \mbox{\hyperlink{struct__aes__ctx}{aes\_ctx}} *ks);}
\DoxyCodeLine{581  }
\DoxyCodeLine{582 }
\DoxyCodeLine{591  \textcolor{keywordtype}{void} aes\_ecb\_unsafe\_decrypt(\textcolor{keyword}{const} \textcolor{keywordtype}{void} *block\_in, \textcolor{keywordtype}{void} *block\_out, \mbox{\hyperlink{struct__aes__ctx}{aes\_ctx}} *ks);}
\DoxyCodeLine{592  }
\DoxyCodeLine{593 }
\DoxyCodeLine{604  \textcolor{keywordtype}{bool} oaep\_encode(}
\DoxyCodeLine{605         \textcolor{keyword}{const} \textcolor{keywordtype}{void} *plaintext,}
\DoxyCodeLine{606         \textcolor{keywordtype}{size\_t} len,}
\DoxyCodeLine{607         \textcolor{keywordtype}{void} *encoded,}
\DoxyCodeLine{608         \textcolor{keywordtype}{size\_t} modulus\_len,}
\DoxyCodeLine{609         \textcolor{keyword}{const} uint8\_t *auth,}
\DoxyCodeLine{610         uint8\_t hash\_alg);}
\DoxyCodeLine{611 }
\DoxyCodeLine{612 }
\DoxyCodeLine{622  \textcolor{keywordtype}{bool} oaep\_decode(}
\DoxyCodeLine{623         \textcolor{keyword}{const} \textcolor{keywordtype}{void} *encoded,}
\DoxyCodeLine{624         \textcolor{keywordtype}{size\_t} len,}
\DoxyCodeLine{625         \textcolor{keywordtype}{void} *plaintext,}
\DoxyCodeLine{626         \textcolor{keyword}{const} uint8\_t *auth,}
\DoxyCodeLine{627         uint8\_t hash\_alg);}
\DoxyCodeLine{628         }
\DoxyCodeLine{629 }
\DoxyCodeLine{641  \textcolor{keywordtype}{bool} pss\_encode(}
\DoxyCodeLine{642         \textcolor{keyword}{const} \textcolor{keywordtype}{void} *plaintext,}
\DoxyCodeLine{643         \textcolor{keywordtype}{size\_t} len,}
\DoxyCodeLine{644         \textcolor{keywordtype}{void} *encoded,}
\DoxyCodeLine{645         \textcolor{keywordtype}{size\_t} modulus\_len,}
\DoxyCodeLine{646         \textcolor{keywordtype}{void} *salt,}
\DoxyCodeLine{647         uint8\_t hash\_alg);}
\DoxyCodeLine{648   }
\DoxyCodeLine{649 }
\DoxyCodeLine{660 \textcolor{keywordtype}{void} powmod(}
\DoxyCodeLine{661         uint8\_t size,}
\DoxyCodeLine{662         uint8\_t *restrict base,}
\DoxyCodeLine{663         uint24\_t exp,}
\DoxyCodeLine{664         \textcolor{keyword}{const} uint8\_t *restrict mod);}
\DoxyCodeLine{665 }
\DoxyCodeLine{666 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{667 }
\DoxyCodeLine{668 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
